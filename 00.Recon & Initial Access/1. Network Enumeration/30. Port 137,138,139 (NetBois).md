# ‚úÖ NetBIOS (137/udp, 138/udp, 139/tcp) Pentesting Checklist & Commands

A practical guide for assessing NetBIOS Name Service, Datagram, and Session Service. Use responsibly and only with proper authorization.

---

## üéØ What am I realistically expecting to find here?

‚≠ê After enumerating NetBIOS (ports 137, 138, 139), I realistically expect to:

- [ ] Discover NetBIOS machine names and workgroups
- [ ] Get the MAC address of the target
- [ ] Identify shared resources or services via SMB (port 139 ties directly to SMB)
- [ ] Gather potential usernames or computer names for password attacks
- [ ] Check for SMB access on port 139

---

## ‚úÖ NetBIOS Pentest Checklist

- [ ] **Confirm Open Ports**
    ```bash
    nmap -sU -sV -p137,138 <IP>
    nmap -sT -sV -p139 <IP>
    ```

- [ ] **Enumerate NetBIOS Names**
    - Query NetBIOS Name Service (137/udp):
    ```bash
    nmblookup -A <IP>
    nbtscan <IP>/24
    sudo nmap -sU -sV -T4 --script nbstat.nse -p137 <IP>
    ```

- [ ] **Check Datagram Service**
    - Usually passive observation. Typically seen as open|filtered:
    ```bash
    nmap -sU -p138 <IP>
    ```

- [ ] **Check Session Service**
    - Connects to SMB on port 139:
    ```bash
    nmap -sT -sV -p139 <IP>
    smbclient -L //<IP> -N
    ```

- [ ] **Follow-Up Enumeration**
    - Use SMB enumeration techniques if 139 is open:
    ```bash
    smbclient //<IP>/<SHARE> -N
    enum4linux-ng <IP>
    crackmapexec smb <IP> --shares
    ```

---

## ‚úÖ NetBIOS Useful Commands

- **nmblookup (Name Service)**
    ```bash
    nmblookup -A <IP>
    ```

- **nbtscan (Name Service)**
    ```bash
    nbtscan <IP>/24
    ```

- **Nmap NSE**
    ```bash
    sudo nmap -sU -sV -T4 --script nbstat.nse -p137 <IP>
    ```

- **Nmap Scanning Example**
    ```bash
    nmap -sU -sV -p137,138 <IP>
    nmap -sT -sV -p139 <IP>
    ```

- **SMB Enumeration (Session Service)**
    ```bash
    smbclient -L //<IP> -N
    enum4linux-ng <IP>
    crackmapexec smb <IP> --shares
    ```

---

## ‚úÖ Defensive Recommendations

- Disable NetBIOS over TCP/IP if not required.
- Restrict access to ports 137, 138, 139 via firewall.
- Harden SMB shares and enforce authentication.
- Monitor and log NetBIOS name queries and SMB connections.
