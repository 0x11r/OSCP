# MSRPC Pentesting Checklist & Commands

## üéØ What am I realistically expecting to find here?

‚≠ê After enumerating MSRPC (ports 135, 593), I realistically expect to:

- [ ] List exposed RPC services and their named pipes
- [ ] Discover interesting interfaces (LSARPC, SAMR, SVCCTL) for enumeration or RCE
- [ ] Identify potential for user enumeration or password brute-force
- [ ] Gather target IP addresses (including IPv6) via IOXIDResolver


## ‚úÖ MSRPC Pentest Checklist

- [ ] **Confirm Open Ports**
    ```bash
    nmap -sV -p135,593 <IP>
    ```

- [ ] **Enumerate RPC Endpoints**
    ```bash
    nmap --script msrpc-enum -p135 <IP>
    rpcdump.py <IP> -p 135
    ```

- [ ] **Identify Exposed Named Pipes**
    - Look for:
        - \pipe\lsarpc (user / group enumeration)
        - \pipe\samr (SAM enumeration)
        - \pipe\svcctl (remote command execution)
        - \pipe\atsvc (scheduled task RCE)
        - \pipe\winreg (registry access)
        - \pipe\epmapper

- [ ] **Metasploit Enumeration**
    ```bash
    use auxiliary/scanner/dcerpc/endpoint_mapper
    use auxiliary/scanner/dcerpc/hidden
    use auxiliary/scanner/dcerpc/management
    rpcdump.py <IP>
    ```

- [ ] **Check for IP Leak via IOXIDResolver**
    - Possible to enumerate internal IPv4/IPv6 addresses
    - Tool:
        ```bash
        git clone https://github.com/mubix/IOXIDResolver
        python IOXIDResolver.py <IP>
        ```

- [ ] **Advanced Nmap Scripts**
    ```bash
    nmap --script msrpc-enum,msrpc-info -p135 <IP>
    ```

---

## ‚úÖ MSRPC Useful Commands

- **Nmap Scan**
    ```bash
    nmap -sV -p135,593 <IP>
    nmap --script msrpc-enum -p135 <IP>
    ```

- **Rpcdump**
    ```bash
    rpcdump.py <IP> -p 135
    ```

- **Metasploit Modules**
    ```bash
    use auxiliary/scanner/dcerpc/endpoint_mapper
    use auxiliary/scanner/dcerpc/hidden
    use auxiliary/scanner/dcerpc/management
    ```

- **IOXIDResolver (Advanced)**
    ```bash
    python IOXIDResolver.py <IP>
    ```

---

## ‚úÖ Defensive Recommendations

- Restrict RPC access to trusted IPs only
- Use Windows Firewall to limit RPC ports
- Disable unused RPC interfaces
- Patch systems to close known vulnerabilities in RPC services
