
---

> RustScan

```c
sudo rustscan -t 1500 -b 1500 --ulimit 65000 -a <IP> -- -sV -sC -oA ./{{ip}}
```

> Basic Scanning Using Nmap

```c
# Host Discovery
sudo nmap 10.129.2.0/24 -sn -oA tnet | grep for | cut -d" " -f5
fping -ag 10.129.2.0/24 2>/dev/null

# Scan ip List
sudo nmap -sn -oA tnet -iL hosts.lst | grep for | cut -d" " -f5
sudo nmap -sn -oA tnet 10.129.2.18 10.129.2.19 

# Host And Port Scanning &  Disable ICMP and Arp 
sudo nmap 10.129.2.28 --top-ports=10
sudo nmap 10.129.2.28 -p 21 --packet-trace -Pn -n --disable-arp-ping

# Saving Results
- Normal output (-oN) with the .nmap file extension
- Grepable output (-oG) with the .gnmap file extension
- XML output (-oX) with the .xml file extension

# Convert xml to html
xsltproc target.xml -o target.html

# Script Engine
sudo nmap 10.129.2.28 -p 25 --script *service-name*
sudo nmap 10.129.2.28 -p 25 --script vuln 

# Firewall And IDS/IPS Evasion
sudo nmap 10.129.2.28 -p 21,22,25 -sS -Pn -n --disable-arp-ping --packet-trace
sudo nmap 10.129.2.28 -p 21,22,25 -sA -Pn -n --disable-arp-ping --packet-trace
sudo nmap 10.129.2.28 -p 80 -sS -Pn -n --disable-arp-ping --packet-trace -D RND:5
sudo nmap 10.129.2.28 -n -Pn -p 445 -O -S 10.129.2.200 -e tun0
sudo nmap 10.129.2.28 -p50000 -sS -Pn -n --disable-arp-ping --packet-trace --source-port 53

# Connect to Filtered Port
ncat -nv --source-port 53 10.129.2.28 50000
```

> Firewall and IDS/IPS Evasion - Easy Lab

```c
# Scan The Target ip
$ sudo nmap 10.129.202.219  -sS -Pn -n --disable-arp-ping  --source-port 53 -O
PORT   STATE SERVICE
21/tcp open  ftp
22/tcp open  ssh

# Check The ssh
$ nc -nv 10.129.202.219 22                
(UNKNOWN) [10.129.202.219] 22 (ssh) open
SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.4
```

> Firewall and IDS/IPS Evasion - Hard Lab

```c
$ ncat -nv --source-port 53 $ip 50000        
Ncat: Version 7.95 ( https://nmap.org/ncat )
Ncat: Connected to 10.129.144.191:50000.
```

> Ping Sweep

```bash
# Bash
for i in {1..254}; do ping -c 1 -W 1 192.168.1.$i &>/dev/null && echo "Host 192.168.1.$i is up."; done

# Powershell
1..255 | % {echo "192.168.1.$_"; ping -n 1 -w 100 192.168.1.$_} | Select-String ttl

# CMD
for /L %i in (1,1,255) do @ping -n 1 -w 200 192.168.1.%i > nul && echo 192.168.1.%i is up.
```
---
