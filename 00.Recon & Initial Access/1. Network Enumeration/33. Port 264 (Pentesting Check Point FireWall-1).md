# Check Point FireWall-1 (Port 264) Pentesting Checklist & Commands

## üéØ What am I realistically expecting to find here?

‚≠ê After enumerating port 264/TCP (Check Point FireWall-1), I realistically expect to find:

- [ ] Firewall hostname (CN)
- [ ] Management Station / SmartCenter hostname
- [ ] Confirmation the target is a CheckPoint device
- [ ] Possible exposure of ICA certificate naming info
- [ ] Potential for fingerprinting firewall topology

---

## ‚úÖ Check Point 264 Pentest Checklist

- [ ] **Identify Open Port 264**
  - Confirm service is listening:
    ```bash
    nmap -p 264 <IP>
    ```

- [ ] **Run Metasploit Module to Grab Hostname**
  - Use auxiliary module to pull firewall and management names:
    ```bash
    msfconsole
    use auxiliary/gather/checkpoint_hostname
    set RHOST <IP>
    run
    ```

- [ ] **Manual Request with Netcat**
  - Use crafted payload to extract CN info:
    ```bash
    printf '\x51\x00\x00\x00\x00\x00\x00\x21\x00\x00\x00\x0bsecuremote\x00' | nc -q 1 <IP> 264 | grep -a CN | cut -c 2-
    ```

- [ ] **Review ICA Certificate Details**
  - Inspect output for:
    - CN (Common Name)
    - O (Organization)
    - ICA naming that may help in social engineering

---

## ‚úÖ Check Point 264 Useful Commands

- **Metasploit Example**
    ```bash
    use auxiliary/gather/checkpoint_hostname
    set RHOST <IP>
    run
    ```

    **Sample Output:**
    ```
    [*] Attempting to contact Checkpoint FW1 SecuRemote Topology service...
    [+] Appears to be a CheckPoint Firewall...
    [+] Firewall Host: FIREFIGHTER-SEC
    [+] SmartCenter Host: FIREFIGHTER-MGMT.example.com
    [*] Auxiliary module execution completed
    ```

- **Manual Netcat Example**
    ```bash
    printf '\x51\x00\x00\x00\x00\x00\x00\x21\x00\x00\x00\x0bsecuremote\x00' | nc -q 1 <IP> 264
    ```

    **Sample Output:**
    ```
    CN=Panama,O=MGMTT.srv.rxfrmi
    ```

---

## ‚úÖ Notes

- Check Point FireWall-1 often exposes management and topology info on **264/TCP** before auth.
- Fingerprinting this service can reveal valuable naming and infrastructure details.
- Results can aid in phishing, social engineering, or internal mapping for lateral movement.
- Always ensure you have authorization before running these tests.

---

## ‚úÖ Shodan Dork

- `port:264`
