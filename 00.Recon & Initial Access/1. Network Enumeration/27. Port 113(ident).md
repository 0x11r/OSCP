# ‚úÖ Ident (113/tcp) Pentesting Checklist & Commands

A practical guide for assessing the Ident service (Identification Protocol) during penetration tests. Use responsibly and only with proper authorization.

---

## üéØ What am I realistically expecting to find here?

‚≠ê After enumerating Ident (default port 113), I realistically expect to:

- [ ] Determine the user/owner of specific TCP connections
- [ ] Gather potential usernames for brute-force attacks
- [ ] Fingerprint running services by associated users
- [ ] Identify misconfigurations that leak sensitive process-user mapping

---

## ‚úÖ Ident Pentest Checklist

- [ ] **Confirm Ident Service**
    - Verify port 113 is open and service is running.
    ```bash
    nmap -sV -p113 <IP>
    nc -vn <IP> 113
    ```

- [ ] **Enumerate Users Manually**
    - Manually query which user owns a given connection.
    ```bash
    echo "43218 , 445" | nc <IP> 113
    ```
    - Useful when targeting services like Samba (port 445) to see running user.

- [ ] **Nmap Default Scripts**
    - Default scripts (`-sC`) often enumerate users automatically.
    ```bash
    nmap -sC -sV -p113,22,139,445 <IP>
    ```
    - Sample output:
      ```
      |_auth-owners: root
      |_auth-owners: identd
      ```

- [ ] **Automated Enumeration with ident-user-enum**
    - Install tool:
      ```bash
      sudo apt install ident-user-enum
      ```
    - Run enumeration against common ports:
      ```bash
      ident-user-enum <IP> 22 113 139 445
      ```
    - Example output:
      ```
      192.168.1.100:22  root
      192.168.1.100:113 identd
      192.168.1.100:139 root
      192.168.1.100:445 root
      ```

- [ ] **Check for Misconfigurations**
    - Observe if the service is leaking user mappings for *all* ports.
    - Attempt unexpected or malformed queries.

- [ ] **Check Ident Configuration Files (If Access)**
    - Example location:
      ```
      /etc/identd.conf
      ```

---

## ‚úÖ Ident Useful Commands

- **Banner Grabbing**
    ```bash
    nc -vn <IP> 113
    ```

- **Manual Query**
    ```bash
    echo "43218 , 445" | nc <IP> 113
    ```

- **Nmap Scanning**
    ```bash
    nmap -sC -sV -p113 <IP>
    ```

- **Automated User Enumeration**
    ```bash
    ident-user-enum <IP> 22 113 139 445
    ```

- **Shodan Search**
    ```
    oident
    ```

---

## ‚úÖ Defensive Recommendations

- Disable Ident service if not needed.
- Restrict access to port 113 to trusted IP addresses only.
- Configure identd to limit or anonymize user responses.
- Monitor logs for unexpected Ident queries.
- Apply patches and use updated identd implementations with security fixes.

