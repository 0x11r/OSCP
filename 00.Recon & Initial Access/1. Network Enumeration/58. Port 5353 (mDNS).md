# mDNS (Multicast DNS) Pentesting Checklist & Commands

## üéØ What am I realistically expecting to find here?

‚≠ê After enumerating mDNS (port 5353/UDP), I realistically expect to find:

- [ ] Local network service advertisements (printers, workstations)
- [ ] Service types and protocols (ssh, smb, http)
- [ ] Hostnames/IP addresses of devices on the same subnet
- [ ] Potential targets for lateral movement
- [ ] No direct remote code execution

---

## ‚úÖ mDNS Pentest Checklist

- [ ] **Service Detection**
  - Verify mDNS is open:
    ```
    nmap -sU -p 5353 <IP>
    ```

---

- [ ] **Enumerate Advertised Services**
  - Run with NSE script to discover services:
    ```
    nmap -Pn -sUC -p5353 --script=dns-service-discovery <IP>
    ```
  - Example Output:
    ```c
    | dns-service-discovery:
    |   9/tcp workstation
    |     Address=192.168.1.2
    |   22/tcp ssh
    |     Address=192.168.1.2
    |   445/tcp smb
    |     Address=192.168.1.2
    ```

---

- [ ] **Manual mDNS Queries**
  - Using avahi-browse (Linux):
    ```
    avahi-browse -a -r
    ```
  - Using dig:
    ```
    dig @224.0.0.251 -p 5353 -t PTR _services._dns-sd._udp.local
    ```

---

- [ ] **Identify Targets for Lateral Movement**
  - Collect service types and hostnames.
  - Plan targeting of:
    - SMB shares
    - SSH services
    - Printers (for attacks or pivoting)

---

## ‚úÖ Shodan Search

- [ ] mDNS is typically *not* Internet-exposed but check for misconfigured devices:
    ```
    port:5353
    ```

---
