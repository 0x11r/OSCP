# MongoDB Pentesting Checklist & Commands

## üéØ What am I realistically expecting to find here?

‚≠ê After enumerating MongoDB (ports 27017, 27018), I realistically expect to find:

- [ ] Unauthenticated access (no default password)
- [ ] Access to databases and collections
- [ ] User credentials (stored in admin/system collections)
- [ ] Sensitive application data (logs, users, tokens)
- [ ] Ability to insert/update documents (impacting app)
- [ ] MongoDB configuration or version info (for exploits)
- [ ] No direct shell or privilege escalation expected

---

## ‚úÖ MongoDB Pentest Checklist

- [ ] **Banner Grabbing / Connection Test**
  - Confirm service is accessible.
    ```
    nc -vn <IP> 27017
    mongo <IP>
    ```

- [ ] **Default Login Check**
  - Test connections without credentials.
    ```
    mongo <IP>
    mongo <IP>:<PORT>/<DB>
    ```
  - Test common login.
    ```
    mongo <database> -u <username> -p '<password>'
    ```

- [ ] **Nmap Scan**
  - Identify service and run default MongoDB scripts.
    ```
    nmap -sV --script "mongo* and default" -p 27017 <IP>
    nmap -n -sV --script mongodb-brute -p 27017 <IP>
    ```

- [ ] **Manual Enumeration (Shell)**
  - Start mongo shell and enumerate.
    ```bash
    show dbs
    use <db>
    show collections
    db.<collection>.find()
    db.<collection>.count()
    db.<collection>.find({"username":"admin"})
    ```
  - Example Python with pymongo:
    ```python
    from pymongo import MongoClient
    client = MongoClient(host, port, username=username, password=password)
    client.server_info()
    for db in client.list_databases():
        print(db)
        print(client[db["name"]].list_collection_names())
    ```

- [ ] **Configuration Check (if local access)**
  - Determine if auth is required.
    ```
    grep "noauth.*true" /opt/bitnami/mongodb/mongodb.conf | grep -v "^#"
    grep "auth.*true" /opt/bitnami/mongodb/mongodb.conf | grep -v "^#\|noauth"
    ```
  - Disable auth if root access.
    ```
    # Edit mongodb.conf:
    noauth = true
    # Restart service
    ```

- [ ] **Brute Force Credentials**
  - Try password sprays or brute force.
    ```
    hydra -l <user> -P passwords.txt mongo://<IP>
    ```

- [ ] **ObjectID Analysis**
  - Predict and brute force Object IDs.
    ```
    git clone https://github.com/andresriancho/mongo-objectid-predict
    python mongo-objectid-predict.py <starting_objectid>
    ```
---

## ‚úÖ Defensive Recommendations

- Enable access control and require authentication.
- Bind MongoDB only to localhost or trusted internal IPs.
- Disable older REST interfaces (port 28017).
- Enforce strong passwords and limit user permissions.
- Use encryption in transit (TLS) and at rest.
- Monitor logs for suspicious activity.

