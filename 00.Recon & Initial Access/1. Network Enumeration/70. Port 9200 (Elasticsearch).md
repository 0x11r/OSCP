# Elasticsearch Pentesting Checklist & Commands

## üéØ What am I realistically expecting to find here? - 
check the website (hacktricks) if i am lost

‚≠ê After enumerating Elasticsearch (port 9200), I realistically expect to find:

- [ ] Open unauthenticated HTTP API access
- [ ] Full read access to all indices and documents
- [ ] Information disclosure (cluster details, node details)
- [ ] Possible write access for persistence or tampering
- [ ] User/role enumeration (if auth enabled)
- [ ] Potential default/weak credentials (elastic:changeme)

---

## ‚úÖ Elasticsearch Pentest Checklist

- [ ] **Banner Grabbing**
  - Check for cluster info and version.
    ```
    curl -X GET "http://<IP>:9200/"
    ```

- [ ] **Check for Authentication**
  - Verify if auth is required or bypassed.
    ```
    curl -X GET "http://<IP>:9200/_xpack/security/user"
    ```

- [ ] **Bruteforce Authentication (If Required)**
  - Try default/weak creds.
    ```
    curl -X GET "http://elastic:changeme@<IP>:9200/"
    ```

---

## ‚úÖ Info Gathering Endpoints

- [ ] **Cluster and Node Info**
    ```
    curl "http://<IP>:9200/_cat/nodes?v"
    curl "http://<IP>:9200/_cluster/health?pretty"
    curl "http://<IP>:9200/_cluster/state?pretty"
    curl "http://<IP>:9200/_nodes?pretty"
    ```

- [ ] **Indices Enumeration**
    ```
    curl "http://<IP>:9200/_cat/indices?v"
    ```

- [ ] **Dump Entire Index**
    ```
    curl "http://<IP>:9200/<index>/_search?pretty=true&size=1000"
    ```

- [ ] **Dump All Indices**
    ```
    curl "http://<IP>:9200/_search?pretty=true&size=1000"
    ```

- [ ] **Search Queries**
    - Raw search across all indices.
      ```
      curl "http://<IP>:9200/_search?pretty=true&q=<search_term>"
      ```
    - Search in specific index.
      ```
      curl "http://<IP>:9200/<index>/_search?pretty=true&q=<search_term>"
      ```

---

## ‚úÖ Security/User Enumeration (If Auth Enabled)

- [ ] **List Roles**
    ```
    curl -X GET "http://<IP>:9200/_security/role"
    ```

- [ ] **List Users**
    ```
    curl -X GET "http://<IP>:9200/_security/user"
    ```

- [ ] **User Details**
    ```
    curl -X GET "http://<IP>:9200/_security/user/<username>"
    ```

---

## ‚úÖ Write Access Check

- [ ] **Create Document / Index**
    ```
    curl -X POST "http://<IP>:9200/bookindex/books" -H 'Content-Type: application/json' -d'
    {
       "bookId": "A00-3",
       "author": "Sankaran",
       "publisher": "Mcgrahill",
       "name": "how to get a job"
    }'
    ```

---

## ‚úÖ Useful _cat Endpoints

- [ ] Quick Discovery
    ```
    curl "http://<IP>:9200/_cat"
    ```
- [ ] Examples
    ```
    /_cat/indices
    /_cat/nodes
    /_cat/shards
    /_cat/plugins
    /_cat/templates
    /_cat/aliases
    ```

---

## ‚úÖ Nmap & Metasploit

- [ ] **Nmap**
    ```
    nmap -sV -p 9200 --script elasticsearch-info <IP>
    ```

- [ ] **Metasploit**
    ```
    use auxiliary/scanner/elasticsearch/indices_enum
    ```

---

## ‚úÖ Tools & References

- [Horuz - Fuzzer](https://github.com/misalabs/horuz)
- [Nmap NSE for Elasticsearch](https://github.com/theMiddleBlue/nmap-elasticsearch-nse)

---

## ‚úÖ Shodan Dorks

- `port:9200 elasticsearch`
