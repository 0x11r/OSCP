# PPTP Pentesting Checklist & Commands

## üéØ What am I realistically expecting to find here?

‚≠ê After enumerating PPTP (port 1723), I realistically expect to find:

- [ ] VPN gateways exposing PPTP service
- [ ] Possible weak MS-CHAPv2 authentication vulnerable to offline cracking
- [ ] Service banner revealing VPN software version
- [ ] Potential downgrade to weak encryption protocols
- [ ] No direct shell or file access

---

## ‚úÖ PPTP Pentest Checklist

- [ ] **Service Detection**
  - Confirm service and version.
    ```
    nmap -Pn -sSV -p1723 <IP>
    ```

- [ ] **Authentication Brute-Force**
  - Attempt login using wordlists.
    ```
    ncrack -p 1723 --user <username> -P rockyou.txt <IP>
    ```

- [ ] **Capture & Crack MS-CHAPv2 Handshake**
  - Use tools to capture handshake and prepare for offline cracking.
    - [chapcrack](https://github.com/moxie0/chapcrack)

- [ ] **Check for Known Weaknesses**
  - PPTP is known to have weak encryption:
    - MS-CHAPv2 handshake can be broken with DES brute force
    - VPN session keys can be recovered
    - More details: [Schneier on PPTP](https://www.schneier.com/academic/pptp/)

---

## ‚úÖ Recommended Tools

- **Nmap**
  - Service detection and scripts
    ```
    nmap -Pn -sSV -p1723 <IP>
    ```

- **Ncrack**
  - Brute force attempts
    ```
    ncrack -p 1723 --user <username> -P passwords.txt <IP>
    ```

- **Chapcrack**
  - Extract and crack MS-CHAPv2 handshakes
    - [GitHub](https://github.com/moxie0/chapcrack)

---

## ‚úÖ Example Attack Flow

1. **Scan for PPTP Service**
    ```
    nmap -Pn -sSV -p1723 <IP>
    ```
2. **Capture PPTP Handshake** (e.g., with Wireshark)
3. **Extract MS-CHAPv2 Hash**
    - Use chapcrack to extract the handshake.
4. **Crack Hash Offline**
    - Use chapcrack or CloudCracker services.
5. **Reuse Credentials** for VPN access.

---

## ‚úÖ Notes

- PPTP is considered deprecated and insecure.
- Always recommend VPN replacements like OpenVPN or IPsec for secure environments.
- Attacks often focus on intercepting and cracking MS-CHAPv2.

---
