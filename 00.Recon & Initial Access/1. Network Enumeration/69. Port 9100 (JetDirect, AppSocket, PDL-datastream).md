# Raw Printing (JetDirect) Pentesting Checklist & Commands

## üéØ What am I realistically expecting to find here?

‚≠ê After enumerating port 9100 (JetDirect / Raw Printing), I realistically expect to find:

- [ ] Open bidirectional print channel with no authentication
- [ ] PJL command support (Printer Job Language)
- [ ] Ability to query printer status, model, firmware version
- [ ] Directory listing of printer storage
- [ ] Ability to upload / download / delete files on printer
- [ ] Potentially sensitive printed documents
- [ ] Possibility to modify printer settings or establish persistence

---

## ‚úÖ Raw Printing Pentest Checklist

- [ ] **Banner Grabbing**
  - Check if port is open and responsive.
    ```
    nc -vn <IP> 9100
    ```

- [ ] **Basic PJL Enumeration**
  - Manually interact with PJL commands.
    ```
    @PJL INFO STATUS
    @PJL INFO ID
    @PJL INFO PRODINFO
    @PJL INFO VARIABLES
    @PJL INFO FILESYS
    @PJL INFO TIMEOUT
    @PJL RDYMSG
    @PJL FSINIT
    ```

- [ ] **Filesystem Enumeration**
  - List printer storage and files.
    ```
    @PJL FSDIRLIST NAME="0:\" ENTRY=1 COUNT=65535
    ```

- [ ] **File Upload / Download / Delete**
  - Test ability to manipulate printer files.
    ```
    @PJL FSUPLOAD
    @PJL FSDOWNLOAD
    @PJL FSDELETE
    ```

- [ ] **Nmap Scan**
  - Use Nmap to identify service and check scripts.
    ```
    nmap -sV --script pjl-ready-message -p9100 <IP>
    ```

- [ ] **Metasploit Modules**
  - Use built-in modules for automated enumeration and exploitation.
    ```
    use auxiliary/scanner/printer/printer_env_vars
    use auxiliary/scanner/printer/printer_list_dir
    use auxiliary/scanner/printer/printer_list_volumes
    use auxiliary/scanner/printer/printer_ready_message
    use auxiliary/scanner/printer/printer_version_info
    use auxiliary/scanner/printer/printer_download_file
    use auxiliary/scanner/printer/printer_upload_file
    use auxiliary/scanner/printer/printer_delete_file
    ```

- [ ] **Use PRET Tool**
  - Best tool for automating attacks and testing printers.
    - [PRET GitHub Repository](https://github.com/RUB-NDS/PRET)
    - Example usage:
      ```
      python pret.py <IP> 9100
      ```

---

## ‚úÖ Notes & Tips

- PJL commands often work even without authentication.
- Many printers store previous print jobs in memory or on disk.
- Uploading malicious files can sometimes enable persistence or exploit firmware bugs.
- Always verify what filesystems are available with:
    ```
    @PJL INFO FILESYS
    ```

---

## ‚úÖ Best Reference for Hacking Printers

- [Hacking Printers Wiki - Filesystem Access](https://hacking-printers.net/wiki/index.php/File_system_access)

---

## ‚úÖ Shodan Dorks

- `pjl port:9100`
