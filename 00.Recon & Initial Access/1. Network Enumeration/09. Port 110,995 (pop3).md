# POP3 Pentesting Checklist & Commands

## üéØ What am I realistically expecting to find here?

‚≠ê After enumerating POP3 (ports 110/995), I realistically expect to find:

- [ ] Valid username and password combinations via brute-force or manual testing
- [ ] Service banner revealing server version (for potential exploits)
- [ ] Access to mailbox contents after successful login
- [ ] Emails containing sensitive information (credentials, internal details)
- [ ] Potential reused credentials valid on other services (SSH, RDP, Web)
- [ ] Support for encrypted connections (SSL/TLS on port 995)


---

## ‚úÖ POP3 Pentest Checklist

- [ ] **Nmap Scan**
    ```bash
    nmap --script "pop3-capabilities or pop3-ntlm-info" -sV -p <PORT> <IP>
    ```

- [ ] **Banner Grabbing**
    ```bash
    nc -nv <IP> 110
    telnet <IP> 110
    openssl s_client -connect <IP>:995 -crlf -quiet
    ```

- [ ] **Check Version for Exploits**
    - Identify the server version in the banner.
    - Search for known exploits:
    ```bash
    searchsploit <version>
    ```

- [ ] **Brute-Force Accounts**
    ```bash
    hydra -l <username> -P /path/to/passwords.txt -f <IP> pop3 -V
    hydra -S -v -l <username> -P /path/to/passwords.txt -s 995 -f <IP> pop3 -V
    ```

- [ ] **Check Mails for Credentials**
    - After login, review messages for sensitive data.

---

## ‚úÖ POP3 Useful Commands

- **Basic POP3 Commands**
    ```
    USER uid           Log in as "uid"
    PASS password      Substitute your actual password
    STAT               List number of messages, total mailbox size
    LIST               List messages and sizes
    RETR n             Show message n
    DELE n             Mark message n for deletion
    RSET               Undo any changes
    QUIT               Logout
    TOP msg n          Show first n lines of message number msg
    CAPA               Get server capabilities
    ```

- **Metasploit Module**
    ```bash
    use auxiliary/scanner/pop3/pop3_login
    ```

---

## ‚úÖ Example Session

```bash
telnet <IP> 110
+OK beta POP3 server (JAMES POP3 Server 2.3.2) ready
USER billydean
+OK
PASS password
+OK Welcome billydean

list
+OK 2 1807
1 786
2 1021

retr 1
+OK Message follows
From: jamesbrown@motown.com

Dear Billy Dean,

Here is your login for remote desktop ... try not to forget it this time!
username: billydean
password: PA$$W0RD!Z
