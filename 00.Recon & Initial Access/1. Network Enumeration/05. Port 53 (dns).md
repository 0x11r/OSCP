# DNS Pentesting Checklist & Commands

## üéØ What am I realistically expecting to find here?

‚≠ê After enumerating DNS (port 53), I realistically expect to find:

- [ ] Zone transfer results leaking entire DNS records
- [ ] Subdomains and additional hosts in the target scope
- [ ] Hostname to IP mappings through A, AAAA, and PTR records
- [ ] Internal network information accidentally exposed
- [ ] Service banners (version.bind) revealing server version
- [ ] Brute-forced or wordlist-discovered subdomains
- [ ] Reverse lookup results showing hidden assets
- [ ] Vulnerabilities in specific DNS server versions (rare)
- [ ] Information useful for further phishing or social engineering


## ‚úÖ DNS Pentest Checklist

- [ ] **Nmap Scan**

```bash
nmap -n --script "(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport" <IP>
nmap --script dns-nsid <IP>
```


- [ ] **Check for Zone Transfer**

```
dig axfr <DOMAIN> @<NS>
fierce --domain <DOMAIN> --dns-servers <DNS_IP>
dnsenum <TARGET>
dnsrecon -d <DOMAIN> -t axfr
```


- [ ] **Check Subdomains**
```
dig any <DOMAIN>
dnsrecon -D subdomains-1000.txt -d <DOMAIN> -n <IP_DNS>
dnscan -d <domain> -r -w subdomains-1000.txt
gobuster dns -d <DOMAIN> -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt
```


- [ ] **Banner Grabbing**
```bash
dig version.bind CHAOS TXT @<DNS_IP>
```


- [ ] **Brute-Force Subdomains**

```bash
dnsrecon -d <DOMAIN> -D words.txt -t brt
dnscan -d <domain> -r -w subdomains-1000.txt
```


- [ ] **Hostname Leak / Reverse Lookups**

```bash
    dnsrecon -r <IP_RANGE> -n <DNS_IP> -d <DOMAIN>
```
---

## ‚úÖ Useful Commands

- **nslookup**
    nslookup
    > server <IP>
    > <DOMAIN>

- **Advanced nslookup Example**

```bash
nslookup
> server 192.212.168.3
> set q=NS
> witrap.com
```

- **Banner Grabbing**
```bash
dig version.bind CHAOS TXT @<DNS_IP>
```

- **Zone Transfer Attempts**
```bash
dig axfr <DOMAIN> @<NS>
dig axfr @<DNS_IP>
dig @<DNS_IP> <DOMAIN> -t AXFR +nocookie
fierce --domain <DOMAIN> --dns-servers <DNS_IP>
dnsenum <TARGET>
dnsrecon -d <DOMAIN> -t axfr
```


- **Brute-Force Subdomains**

```bash
dnsrecon -D subdomains-1000.txt -d <DOMAIN> -n <DNS_IP>
dnscan -d <domain> -r -w subdomains-1000.txt
gobuster dns -d <DOMAIN> -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt
```


- **Reverse Lookups**

```bash
dnsrecon -r <IP_RANGE> -n <DNS_IP> -d <DOMAIN>
dnsrecon -d <IP> -r 10.0.0.0/8
```


- **Host Command Examples**
```bash
sudo vim /etc/hosts
10.10.10.123 friendzone.red
host -l 10.10.10.123 friendzone.red
host -t axfr witrap.com 192.212.168.3
```


- **dnsrecon Examples**

```bash
dnsrecon -d target.com -t axfr
dnsrecon -d target.com -D words.txt -t brt
dnsrecon -d <DOMAIN> -a
dnsrecon -r <IP_RANGE> -n <DNS_IP> -d <DOMAIN>
```

- **Metasploit**

```bash
auxiliary/gather/enum_dns
```
- **Other Tools**

```bash
https://github.com/blark/aiodnsbrute
```
