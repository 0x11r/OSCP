# VNC Pentesting Checklist & Commands

## üéØ What am I realistically expecting to find here?

‚≠ê After enumerating VNC (ports 5800, 5801, 5900, 5901), I realistically expect to find:

- [ ] Open VNC servers accepting connections
- [ ] Banner or version info (RealVNC, TightVNC, etc.)
- [ ] Sessions with **no authentication** (dangerous misconfig)
- [ ] Weak or reused passwords (for brute force)
- [ ] Potential access to remote GUI desktop
- [ ] Possible password hashes (for cracking)
- [ ] No direct shell, but control over GUI apps

---

## ‚úÖ VNC Pentest Checklist

- [ ] **Banner Grabbing & Service Detection**
    - Check for VNC service and info.
    ```
    nmap -sV --script vnc-info,vnc-title -p 5900,5901,5800,5801 <IP>
    ```
    - Sample nmap scripts:
        - `vnc-info` - Grabs VNC protocol version
        - `vnc-title` - Gets session window title

---

- [ ] **Check for Authentication Bypass**
    - Try RealVNC no-auth bypass vulnerability (older versions).
    ```
    nmap --script realvnc-auth-bypass -p <PORT> <IP>
    ```

---

- [ ] **Metasploit Enumeration**
    - Scan for servers allowing no authentication.
    ```
    msf> use auxiliary/scanner/vnc/vnc_none_auth
    msf> set RHOSTS <IP>
    msf> run
    ```

---

- [ ] **Connect to VNC Server**
    - Try with or without password file.
    ```
    vncviewer <IP>::5901
    vncviewer -passwd passwd.txt <IP>::5900
    ```

---

- [ ] **Brute Forcing VNC Password**
    - Common VNC password brute force tools:
    ```
    medusa -M vnc -h <IP> -U users.txt -P passwords.txt -n 5900
    ncrack -p 5900 --user '' -P passwords.txt <IP>
    ```
    - Watch for account lockouts!

---

## ‚úÖ Decrypting Saved VNC Passwords

- **Linux Default Location**
    - Check for stored password:
    ```
    cat ~/.vnc/passwd
    ```

- **Decrypt Encrypted Password**
    - Passwords are typically 3DES encrypted.
    - Tool (Linux): [vncpwd](https://github.com/jeroennijhof/vncpwd)
    ```bash
    git clone https://github.com/jeroennijhof/vncpwd
    cd vncpwd
    make
    ./vncpwd ~/.vnc/passwd
    ```

- **Alternative Windows Tool**
    - [Raymond.cc VNC Password Recovery](https://www.raymond.cc/blog/download/did/232/)
    - Also mirrored here:
    ```
    https://1116388331-files.gitbook.io/~/files/v0/b/gitbook-legacy-files/o/assets%2F-Mks5MA8MikNk7jIq3z3%2Fsync%2F25737271ebaa6bbe3abcce97e8a6737fbc14260b.zip?generation=1633028916046335&alt=media
    ```

---

## ‚úÖ Shodan Search

- [ ] Discover exposed VNC servers.
    ```
    port:5900 RFB
    port:5901 RFB
    ```

---

## ‚úÖ Notes & Tips

- VNC servers often use:
    - **5800/5801** for **web-based Java client** access (HTTP)
    - **5900/5901** for **native VNC client** access (RFB protocol)
- Some implementations allow viewing without controlling if password is wrong.
- **Be cautious**: connecting can trigger logs or lockouts.
