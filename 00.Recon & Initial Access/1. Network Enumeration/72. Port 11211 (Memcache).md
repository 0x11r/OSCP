# NDMP Pentesting Checklist & Commands

## üéØ What am I realistically expecting to find here?

‚≠ê After enumerating NDMP (port 10000), I realistically expect to find:

- [ ] Backup software version information
- [ ] Filesystem info (mounted shares, paths)
- [ ] Backup configurations that may leak sensitive data
- [ ] Potential credentials or session IDs
- [ ] No direct shell or privilege escalation, but info useful for lateral movement

---

## ‚úÖ NDMP Pentest Checklist

- [ ] **Banner Grabbing**
  - Check for version and vendor.
    ```
    nmap -n -sV -p10000 <IP>
    ```

- [ ] **Nmap Scripts**
  - Gather filesystem info and NDMP version details.
    ```
    nmap -n -sV --script "ndmp-fs-info or ndmp-version" -p10000 <IP>
    ```

- [ ] **Manual Testing**
  - Connect with netcat or telnet (often responds in clear text).
    ```
    nc <IP> 10000
    ```

- [ ] **Useful Commands - Manual**

```c
echo "version" | nc -vn -w 1 <IP> 11211      #Get version
echo "stats" | nc -vn -w 1 <IP> 11211        #Get status
echo "stats slabs" | nc -vn -w 1 <IP> 11211  #Get slabs
echo "stats items" | nc -vn -w 1 <IP> 11211  #Get items of slabs with info
echo "stats cachedump <number> 0" | nc -vn -w 1 <IP> 11211  #Get key names (the 0 is for unlimited output size)
echo "get <item_name>" | nc -vn -w 1 <IP> 11211  #Get saved info

#This php will just dump the keys, you need to use "get <item_name> later"
sudo apt-get install php-memcached
php -r '$c = new Memcached(); $c->addServer("localhost", 11211); var_dump( $c->getAllKeys() );'

sudo apt install libmemcached-tools
memcstat --servers=127.0.0.1 #Get stats
memcdump --servers=127.0.0.1 #Get all items
memccat  --servers=127.0.0.1 <item1> <item2> <item3> #Get info inside the item(s)
```

- [ ] **Useful Commands - Automatic**

```c
nmap -n -sV --script memcached-info -p 11211 <IP>   #Just gather info
msf > use auxiliary/gather/memcached_extractor      #Extracts saved data
msf > use auxiliary/scanner/memcached/memcached_amp #Check is UDP DDoS amplification attack is possible
```

---

## ‚úÖ Goals During Enumeration

- [ ] Identify NDMP server vendor/version (e.g., Symantec/Veritas Backup Exec)
- [ ] Extract list of mounted filesystems or backup paths
- [ ] Look for sensitive backup paths containing credentials
- [ ] Map out the NAS environment for lateral movement

---

## ‚úÖ Shodan Dorks

- `ndmp`
