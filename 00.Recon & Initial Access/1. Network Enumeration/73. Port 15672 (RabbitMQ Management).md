# RabbitMQ Management Pentesting Checklist & Commands

## üéØ What am I realistically expecting to find here?

‚≠ê After enumerating RabbitMQ Management (port 15672), I realistically expect to find:

- [ ] Access to the RabbitMQ web admin console
- [ ] Default or weak credentials (guest/guest)
- [ ] Queues, exchanges, bindings, and vhost configurations
- [ ] Message data in queues
- [ ] Ability to publish messages (possible injection or DoS)
- [ ] API endpoints that leak information
- [ ] No direct shell or privilege escalation expected

---

## ‚úÖ RabbitMQ Management Pentest Checklist

- [ ] **Banner Grabbing**
  - Check if management console is live.
    ```
    curl -I http://<IP>:15672
    ```

- [ ] **Default Credentials Check**
  - Try common/default creds.
    ```
    Username: guest
    Password: guest
    ```
  - Also test for reused application creds.

- [ ] **Brute Force Login**
  - Attempt password spraying or form brute force.
    ```
    hydra -l guest -P passwords.txt http-post-form "/login:username=^USER^&password=^PASS^:Invalid" <IP>
    ```

- [ ] **Nmap Scan**
  - Identify service details.
    ```
    nmap -sV -p15672 <IP>
    ```

- [ ] **Enumerate via API**
  - With valid creds, dump API data.
    ```
    curl -u guest:guest http://<IP>:15672/api/overview
    curl -u guest:guest http://<IP>:15672/api/connections
    curl -u guest:guest http://<IP>:15672/api/queues
    curl -u guest:guest http://<IP>:15672/api/exchanges
    ```

- [ ] **Publish to Queue**
  - Test if you can inject payloads.
    ```
    curl -u guest:guest -H "content-type:application/json" -X POST http://<IP>:15672/api/exchanges/%2F/amq.default/publish -d '{
      "properties":{},
      "routing_key":"test",
      "payload":"test message",
      "payload_encoding":"string"
    }'
    ```

- [ ] **Manual Plugin Check (if local access)**
  - Enable management if not running.
    ```
    rabbitmq-plugins enable rabbitmq_management
    service rabbitmq-server restart
    ```

---

## ‚úÖ Goals During Enumeration

- [ ] Identify admin interface exposure
- [ ] Extract users, permissions, vhosts
- [ ] List and review queues and exchanges
- [ ] Identify possible sensitive data in messages
- [ ] Check for ability to write messages or abuse routing

---

## ‚úÖ Shodan Dorks

- `port:15672 http`
