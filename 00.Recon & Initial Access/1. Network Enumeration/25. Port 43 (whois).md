# ‚úÖ WHOIS Pentesting Checklist & Commands


---

## üéØ What am I realistically expecting to find here?

‚≠ê After enumerating WHOIS (default port 43), I realistically expect to find:

- [ ] Registration details for domains (contacts, registrars)
- [ ] Database and version info in server banners
- [ ] Potential misconfigurations exposing extra records
- [ ] Clues about the hosting provider or IP block ownership
- [ ] Possible input-based vulnerabilities (e.g., SQL Injection if service is custom)
- [ ] Info that aids in social engineering or phishing preparation

---

## ‚úÖ WHOIS Pentest Checklist

- [ ] **Identify Service and Banner**
    - Confirm port 43 is open and WHOIS is running.
    ```bash
    nmap -sV -p43 <IP>
    nc -vn <IP> 43
    ```

- [ ] **Query Domain Information**
    - Standard WHOIS request for domain details.
    ```bash
    whois -h <HOST> -p 43 "example.com"
    echo "example.com" | nc -vn <HOST> 43
    ```

- [ ] **Test for SQL Injection or Input-Based Vulnerabilities**
    - Attempt injection payloads if service is custom.
    ```bash
    whois -h <HOST> -p 43 "a') OR 1=1#"
    echo "a') OR 1=1#" | nc -vn <HOST> 43
    ```

- [ ] **Review Server Responses**
    - Look for:
      - Database information leakage
      - Backend system errors
      - WHOIS server software/version details

- [ ] **Use Shodan for Discovery**
    - Identify exposed WHOIS servers.
    ```
    port:43 whois
    ```

---

## ‚úÖ WHOIS Useful Commands

- **Simple WHOIS Query**
    ```bash
    whois -h <HOST> -p 43 "example.com"
    ```

- **Netcat WHOIS Query**
    ```bash
    echo "example.com" | nc -vn <HOST> 43
    ```

- **SQLi Payload Example**
    ```bash
    whois -h <HOST> -p 43 "a') OR 1=1#"
    ```

- **Nmap Banner Grabbing**
    ```bash
    nmap -sV -p43 <IP>
    ```

---

## ‚úÖ Defensive Recommendations

- Restrict WHOIS service access to trusted IP addresses only.
- Sanitize and validate all user inputs to prevent SQL injection.
- Avoid exposing detailed contact or infrastructure data unnecessarily.
- Ensure WHOIS server software is up to date with security patches.
- Monitor and log all WHOIS queries for anomaly detection.
