# Kibana Pentesting Checklist & Commands

## üéØ What am I realistically expecting to find here?

‚≠ê After enumerating Kibana (port 5601), I realistically expect to find:

- [ ] Publicly accessible dashboards or search functionality
- [ ] Access to Elasticsearch data (via Kibana UI)
- [ ] Ability to create or modify users, roles, or API Keys (if authenticated)
- [ ] Misconfigurations (e.g. no auth or weak auth)
- [ ] Old, vulnerable versions (e.g. pre-6.6.0 RCE)
- [ ] Configuration files leaking credentials

---

## ‚úÖ Kibana Pentest Checklist

- [ ] **Check Service Availability**
    ```
    curl -I http://<IP>:5601
    curl -k -I https://<IP>:5601
    ```
    - Look for 200 OK or 302 (redirect to login)

---

- [ ] **Enumerate Service Details**
    ```
    curl http://<IP>:5601/api/status
    ```
    - Reveals version (check for known CVEs)
    - Example vulnerable: **< 6.6.0** has RCE [ref](https://insinuator.net/2021/01/pentesting-the-elk-stack/#ref2)

---

- [ ] **Authentication Check**
    - Test if Kibana is accessible without credentials
        ```
        http://<IP>:5601/app/kibana
        ```
    - *Note:* If Elasticsearch has no auth, Kibana typically has no auth.

---

- [ ] **Brute-Force or Credential Reuse**
    - Use known Elasticsearch credentials
    - Check /etc/kibana/kibana.yml on compromised hosts:
        ```
        grep elasticsearch.username /etc/kibana/kibana.yml
        grep elasticsearch.password /etc/kibana/kibana.yml
        ```
    - Try these credentials in UI.

---

- [ ] **SSL/TLS Check**
    - Verify if HTTPS is enforced.
    - If **HTTP only**, sensitive data may leak in plaintext.

---

- [ ] **In-App Exploration**
    - Once authenticated, check:
        - Stack Management ‚ûú Users
        - Stack Management ‚ûú Roles
        - Stack Management ‚ûú API Keys
    - Look for ability to:
        - Create users
        - Assign roles
        - Generate API Keys

---

- [ ] **Elasticsearch Data Access via Kibana**
    - Use Kibana's Dev Tools ‚ûú Console
        ```
        GET _search
        ```
    - Enumerate indices:
        ```
        GET _cat/indices?v
        ```
    - Dump data:
        ```
        GET index-name/_search
        ```

---

- [ ] **Identify Version**
    - Important for exploit checks:
        ```
        curl http://<IP>:5601/api/status
        ```
    - Kibana <6.6.0: known RCE

---

## ‚úÖ Post-Exploitation Checks

- [ ] **Configuration File on Host**
    ```
    cat /etc/kibana/kibana.yml
    ```
    - May reveal:
        - Elasticsearch username/password
        - SSL/TLS settings
    - Evaluate privilege of found user:
        - **kibana_system** usually limited (monitoring only)
        - Other users may have higher rights

---

## ‚úÖ Shodan Search

- [ ] Discover exposed Kibana instances:
    ```
    port:5601
    title:"Kibana"
    ```

---

## ‚úÖ References

- [Pentesting the ELK Stack](https://insinuator.net/2021/01/pentesting-the-elk-stack/)
