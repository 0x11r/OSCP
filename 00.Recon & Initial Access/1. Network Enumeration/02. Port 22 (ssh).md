# SSH Pentesting Checklist & Commands


## ðŸŽ¯ What am I realistically expecting to find here?
- [ ] Valid user credentials (from brute force or reused from other services)
- [ ] Private keys for login (if discovered on the system)
- [ ] SSH banner/version information (for potential CVEs)
- [ ] Evidence of port knocking sequence (if used)
- [ ] Restricted shell that may be breakable
- [ ] Ability to transfer files via SCP


A practical guide for assessing SSH services during penetration tests. Use responsibly and only with proper authorization.

## âœ… SSH Pentest Checklist

- [ ] **Banner Grabbing & Version Detection**

```
nc <IP> 22
nc -vn <IP> 22
searchsploit openssh
```

- [ ] **Brute-Force / Credential Testing**

```bash
hydra -v -L user.txt -P /usr/share/wordlists/rockyou.txt -t 16 <IP> ssh
hydra -l <username> -P passwords.txt -T 20 <IP> ssh
hydra -V -f -L <USERS_LIST> -P <PASSWORDS_LIST> ssh://<IP> -u -vV
```

- [ ] **Manual Login Attempts**
```bash
ssh <username>@<IP>
ssh <username>@<IP> -i id_rsa
```

- [ ] **User Enumeration Tests**
```
ssh -v <username>@<IP>
```

- [ ] **Check for Private Key Reuse**
```bash
ssh -i id_rsa <user>@<IP>
```


- [ ] **Restricted Shell Breakout**

```bash
ssh <user>@<IP> -t "bash --noprofile"
```


- [ ] **File Transfer (SCP)**

```bash
scp <filename> <username>@<IP>:/path/to/copy
```


- [ ] **SSH Key-Based Access**
    # Attacker Machine

```bash
ssh-keygen
chmod 600 id_rsa
cat id_rsa.pub

# Target Machine
echo id_rsa.pub >> ~/.ssh/authorized_keys

# Connect
ssh -i id_rsa <USER>@<IP>
```

- [ ] **Port Knocking (Advanced)**

```
knock <IP> <SEQ1> <SEQ2> <SEQ3>
nmap -p 22 <IP>
```

## âœ… Recommended Nmap Commands
```
#Default safe scripts and version detection.
nmap -sC -sV -p22 <IP>

#All SSH-related scripts.
 nmap --script ssh-* -p22 <IP>

#Check specific vulnerabilities (OpenSSH CVEs).
 nmap --script ssh2-enum-algos,ssh-hostkey,ssh-auth-methods -p22 <IP>
```


