

---
---
# **Windows - Windows**


base64 encode & decode

```powershell
# Encode File to Base64
[Convert]::ToBase64String([System.IO.File]::ReadAllBytes("C:\Path\To\File.txt")) > encoded.txt

# Decode Base64 to File
[System.IO.File]::WriteAllBytes("C:\Path\To\OutputFile.txt", [Convert]::FromBase64String((Get-Content "C:\Path\To\encoded.txt")))
```

Web Downloads

```powershell
# Method 1: Direct Download
(New-Object Net.WebClient).DownloadFile('http://example.com/file.txt', 'C:\Path\To\file.txt')

# Method 2: Asynchronous Download
(New-Object Net.WebClient).DownloadFileAsync('http://example.com/file.txt', 'C:\Path\To\file.txt')

# Fileless Method (PowerShell Script Download)

# Using Invoke-WebRequest
Invoke-WebRequest -Uri 'https://example.com/file.txt' -OutFile 'C:\Path\To\file.txt'

# Using Basic Parsing (if necessary)
Invoke-WebRequest -Uri 'https://example.com/file.txt' -UseBasicParsing -OutFile 'C:\Path\To\file.txt'
```

SMB Downloads

```powershell
# Create SMB Server (on Linux side; Windows will connect to it)
# This is a Linux command for setting up the SMB server
mkdir /tmp/smbshare
sudo impacket-smbserver share -smb2support /tmp/smbshare

# Download File from SMB Server
Copy-Item -Path '\\192.168.45.208\share\file.txt' -Destination 'C:\Path\To\file.txt'
```

FTP Download

```powershell
# Install FTP Server Python3 Module (Linux command)
# Set up FTP server on Linux
sudo pip3 install pyftpdlib
sudo python3 -m pyftpdlib --port 21

# Download File from FTP Server
(New-Object Net.WebClient).DownloadFile('ftp://192.168.49.128/file.txt', 'C:\Path\To\file.txt')

# FTP Command File for command-line FTP
echo open 192.168.49.128 > ftpcommand.txt
echo USER anonymous >> ftpcommand.txt
echo binary >> ftpcommand.txt
echo GET file.txt >> ftpcommand.txt
echo bye >> ftpcommand.txt
ftp -v -n -s:ftpcommand.txt
```

PowerShell Web Downloads

```powershell
# Set up WebDav Server (Linux command for setup)
# This is a Linux command for setting up the WebDav server
sudo pip install wsgidav cheroot
sudo wsgidav --host=0.0.0.0 --port=80 --root=/tmp --auth=anonymous

# Upload File to WebDav Server
Invoke-WebRequest -Uri 'http://192.168.49.128/SecretUploadDirectory/file.txt' -Method PUT -InFile 'C:\Path\To\file.txt'
```

File Encryption

```powershell
# Import Module for AES Encryption (if using custom module)
Import-Module .\Invoke-AESEncryption.ps1

# Encrypt File
Invoke-AESEncryption -Mode Encrypt -Key "p4ssw0rd" -Path 'C:\Path\To\file.txt'

# Decrypt File
Invoke-AESEncryption -Mode Decrypt -Key "p4ssw0rd" -Path 'C:\Path\To\encrypted_file.txt'
```

---
---
