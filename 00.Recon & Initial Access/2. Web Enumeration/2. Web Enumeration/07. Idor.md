# 🔓 IDOR (Insecure Direct Object Reference) - Pentesting Checklist & Tips

## 🎯 What am I realistically expecting to find here?

⭐ While testing for IDOR vulnerabilities, I realistically expect to:

- [ ] Access another user's data by modifying identifiers
- [ ] Trigger unauthorized actions (password reset, delete, update)
- [ ] Chain leaks (e.g., user ID → message ID → sensitive content)
- [ ] Abuse weak authorization logic in APIs and hidden endpoints
- [ ] Exploit exposed or predictable object references

---

## ✅ IDOR Pentesting Checklist

### 🔍 Unsuspected Areas to Check

- [ ] **Encoded or Hashed IDs**
  - Try decoding base64, hex, or other encodings.
  - Check for low entropy or predictable hash values.
  - Create multiple accounts and observe ID generation patterns.

- [ ] **Indirect ID Leaks via Other Endpoints**
  - Look for places that expose internal IDs:
    ```
    /api/profile?user_id=
    /public/user?id=
    /conversation/list?user_id=
    ```

- [ ] **Blind ID Enumeration**
  - Try accessing:
    ```
    /api/messages?user_id=123
    /api/documents/456
    ```

---

### 🛠️ Manual Testing Techniques

- [ ] **Inject Missing IDs**
  - Add params manually:
    ```
    GET /api/messages
    → Try: /api/messages?user_id=ANOTHER_USER
    ```

- [ ] **HTTP Parameter Pollution (HPP)**
  - Test duplicates:
    ```
    ?user_id=123&user_id=456
    ?user_ids[]=123&user_ids[]=456
    ```

- [ ] **Change HTTP Methods**
  - Try method tampering:
    ```
    POST → PUT
    PUT → DELETE
    GET → PATCH
    ```

- [ ] **Change File Extensions**
  - Try requesting different response formats:
    ```
    /user/123 → /user/123.json
    /doc/789 → /doc/789.xml
    ```

---

### 👻 Blind IDOR Detection

- [ ] **Look for Indirect Signs of Success**
  - Email triggers
  - Export/download features
  - Background tasks
  - SMS/text alerts
  - Logs or counters changing unexpectedly

---

## 🚀 Boosting Impact of IDOR Findings

- [ ] **Prioritize Critical Endpoints**
  - Password reset/change APIs
  - Account deletion or permission modification
  - Email/phone updates or MFA changes

- [ ] **Target Sensitive Read Endpoints**
  - Direct messages
  - Payment details, order history
  - Personal documents or photos
  - Support tickets or audit logs

- [ ] **Chain Multiple IDORs**
  - Leak user ID → find message IDs → read private content

---

## ✅ Sample Payload Ideas

```http
GET /api_v1/messages?user_id=VICTIM_USER_ID
GET /api_v1/profile/VICTIM_USER_ID
GET /files/download/789?user_id=VICTIM
POST /user/update {"user_id":123,"email":"attacker@example.com"}
PUT /api/password-reset {"user_id":123}
```

---

## 🧠 Quick Tips to Remember

- [ ] Don’t trust "random" IDs — always test them.
- [ ] Try injecting object references where none exist.
- [ ] Explore all user roles — admin, guest, premium, etc.
- [ ] Check web, mobile, and API clients separately.
- [ ] Review Swagger docs or JS files for hidden endpoints.

---

