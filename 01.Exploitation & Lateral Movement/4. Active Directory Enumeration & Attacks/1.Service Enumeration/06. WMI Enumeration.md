# üéØ WinRM & WMI Pentesting Checklist & Commands

## What am I realistically expecting to find here?

‚≠ê After enumerating WinRM and WMI services, I realistically expect to:

- [ ] Remotely execute commands using valid credentials
- [ ] Establish an interactive shell via WinRM
- [ ] Abusing WMI for stealthy command execution or lateral movement
- [ ] Use these services for pivoting across the network
- [ ] Enumerate system info, users, and running processes remotely
- [ ] Potentially upload/download files through these sessions

---

# ‚úÖ WinRM & WMI - Authenticated Enumeration & Exploitation

## üõ† Remote Shell via WinRM

```bash
evil-winrm -i 10.10.10.1 -u john -p password123
```

- Interactive PowerShell-like shell over WinRM
- Supports upload/download/invoke module

---

## üß† Remote Execution via WMI (Python / Impacket)

```bash
python3 wmiexec.py test.local/john:password123@10.10.10.1
```

- Executes commands remotely using WMI
- Output shown directly after execution
- Can be used as a stealthy alternative to SMB/WinRM

---

## üîç Notes

- These techniques require **valid credentials**
- Common ports:
  - WinRM (HTTP): 5985
  - WinRM (HTTPS): 5986
- Ensure target has WinRM service running and open

---

## ‚úÖ Privilege Verification After Access

```powershell
whoami /all
whoami /priv
net user john
net localgroup administrators
```

---

## ‚úÖ Useful Post-Access Commands

```powershell
systeminfo
tasklist
netstat -ano
ipconfig /all
net view /domain
net group /domain
```

---

## üîÑ Optional: Use `proxychains` with socks proxy if pivoting from Linux
